import{j as N,x as E,z as O,c as b,h as $,k as L,g as P,_ as X,Q as _,a5 as k,d as l,U as h,ar as Y,a9 as t,aq as H,P as J,a7 as Z,S as D,$ as v,aa as m,a4 as q,r as x,w as A,aw as j,o as W,aE as ee,aF as te,m as le,K as se,q as I,J as ae,a1 as oe,a as ie,Z as z,Y as ne,X as M,F as re,aG as U}from"./index.dc551ac6.js";import{Q as ce}from"./QBadge.9e6b5a46.js";import{Q as ue}from"./QPage.e64a8461.js";import{R as de,V as G}from"./dexie.8617b804.js";import{d as fe}from"./date.ccb51cc0.js";import{emitter as B}from"./mitt.4e333a4b.js";import{o as ve}from"./index.8776d51a.js";import{c as me}from"./index.356d1b45.js";import{u as he}from"./settingsStore.6d20ebcd.js";import{u as _e}from"./QSpace.09ccd3fc.js";import{v as ge}from"./fuelConsumption.d2d2c6e8.js";import{Q as pe}from"./QList.e65e1e10.js";import{u as be,a as ye}from"./use-virtual-scroll.ff57756e.js";import"./format.c860d4da.js";import"./ClosePopup.606a8f34.js";import"./i18n.2b9c7e98.js";const xe=["text","rect","circle","QBtn","QBadge","QChip","QToolbar","QCheckbox","QRadio","QToggle","QSlider","QRange","QInput","QAvatar"],Se=["wave","pulse","pulse-x","pulse-y","fade","blink","none"];var p=N({name:"QSkeleton",props:{...E,tag:{type:String,default:"div"},type:{type:String,validator:e=>xe.includes(e),default:"rect"},animation:{type:String,validator:e=>Se.includes(e),default:"wave"},animationSpeed:{type:[String,Number],default:1500},square:Boolean,bordered:Boolean,size:String,width:String,height:String},setup(e,{slots:i}){const d=P(),o=O(e,d.proxy.$q),s=b(()=>{const n=e.size!==void 0?[e.size,e.size]:[e.width,e.height];return{"--q-skeleton-speed":`${e.animationSpeed}ms`,width:n[0],height:n[1]}}),u=b(()=>`q-skeleton q-skeleton--${o.value===!0?"dark":"light"} q-skeleton--type-${e.type}`+(e.animation!=="none"?` q-skeleton--anim q-skeleton--anim-${e.animation}`:"")+(e.square===!0?" q-skeleton--square":"")+(e.bordered===!0?" q-skeleton--bordered":""));return()=>$(e.tag,{class:u.value,style:s.value},L(i.default))}});const qe={},ke={class:"row"},$e={class:"col-3"},we={class:"row"},Qe={class:"col-2"},Ce={class:"text-h5"},Te={class:"text-subtitle1"},Ve=t("div",{class:"col-1"},null,-1),Re={class:"col-2"},ze={class:"text-h5"},Be={class:"text-subtitle1"},De=t("div",{class:"col-1"},null,-1),Fe={class:"col-2"},Ne={class:"text-h5"},Ae={class:"text-subtitle1"},Ie=t("div",{class:"col-1"},null,-1),Me={class:"col-2"},Ue={class:"text-h5"},Ee={class:"text-subtitle1"};function Oe(e,i){return _(),k("div",null,[l(H,null,{default:h(()=>[l(Y,null,{default:h(()=>[t("div",ke,[t("div",$e,[l(p,{type:"text"})])]),t("div",we,[t("div",Qe,[t("div",Ce,[l(p,{type:"text"})]),t("div",Te,[l(p,{type:"text"})])]),Ve,t("div",Re,[t("div",ze,[l(p,{type:"text"})]),t("div",Be,[l(p,{type:"text"})])]),De,t("div",Fe,[t("div",Ne,[l(p,{type:"text"})]),t("div",Ae,[l(p,{type:"text"})])]),Ie,t("div",Me,[t("div",Ue,[l(p,{type:"text"})]),t("div",Ee,[l(p,{type:"text"})])])])]),_:1})]),_:1})])}var Le=X(qe,[["render",Oe]]);const Pe={class:"row items-center no-wrap"},Ye={class:"col"},He={class:"text-subtitle2"},Je={class:"col-auto space-station"},je={class:"row"},Ge={class:"col-3"},Ke={class:"text-h5 accent-space-station"},Xe={class:"text-subtitle1"},Ze={class:"col-3"},We={class:"text-h5 accent-space-station"},et={class:"text-subtitle1"},tt={class:"col-3"},lt={class:"text-h5 accent-space-station"},st={class:"text-subtitle1"},at={class:"col-3"},ot={class:"text-h5 accent-space-station"},it={class:"text-subtitle1"},nt=J({__name:"RefuelCard",props:{refuel:{type:de,required:!0},vehicle:{type:G,required:!0},fuelConsumption:{type:String,required:!0},loading:{type:Boolean}},setup(e){const i=e,d=fe.formatDate(i.refuel.date,"YYYY-MMM-DD HH:mm");return(o,s)=>(_(),k("div",null,[l(Z,{name:"fadein"},{default:h(()=>[e.loading?(_(),D(Le,{key:1})):(_(),D(H,{key:0,class:"space-station"},{default:h(()=>[l(Y,null,{default:h(()=>{var u,n,g;return[t("div",Pe,[t("div",Ye,[t("div",He,v(m(d)),1)]),t("div",Je,[l(q,{dense:"",round:"",flat:"",icon:"more_vert",onClick:s[0]||(s[0]=w=>m(B).emit("showRefuelOptionsDialog",e.refuel.id))})])]),t("div",je,[t("div",Ge,[t("div",Ke,v(e.fuelConsumption),1),t("div",Xe,v((u=e.vehicle.fuelUnit)==null?void 0:u.fuelConsumptionUnit),1)]),t("div",Ze,[t("div",We,v(e.refuel.distanceDriven),1),t("div",et,v((n=e.vehicle.fuelUnit)==null?void 0:n.distanceUnit),1)]),t("div",tt,[t("div",lt,v(e.refuel.payedAmount),1),t("div",st,v(e.vehicle.currencyUnit),1)]),t("div",at,[t("div",ot,v(e.refuel.refueledAmount),1),t("div",it,v((g=e.vehicle.fuelUnit)==null?void 0:g.fuelUnit),1)])])]}),_:1})]),_:1}))]),_:1})]))}}),rt=["horizontal","vertical","cell","none"];var ct=N({name:"QMarkupTable",props:{...E,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:e=>rt.includes(e)}},setup(e,{slots:i}){const d=P(),o=O(e,d.proxy.$q),s=b(()=>`q-markup-table q-table__container q-table__card q-table--${e.separator}-separator`+(o.value===!0?" q-table--dark q-table__card--dark q-dark":"")+(e.dense===!0?" q-table--dense":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")+(e.square===!0?" q-table--square":"")+(e.wrapCells===!1?" q-table--no-wrap":""));return()=>$("div",{class:s.value},[$("table",{class:"q-table"},L(i.default))])}});function ut(e,i){return $("div",e,[$("table",{class:"q-table"},i)])}const dt={list:pe,table:ct},ft=["list","table","__qtable"];var vt=N({name:"QVirtualScroll",props:{...be,type:{type:String,default:"list",validator:e=>ft.includes(e)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:{default:void 0}},setup(e,{slots:i,attrs:d}){let o;const s=x(null),u=b(()=>e.itemsSize>=0&&e.itemsFn!==void 0?parseInt(e.itemsSize,10):Array.isArray(e.items)?e.items.length:0),{virtualScrollSliceRange:n,localResetVirtualScroll:g,padVirtualScroll:w,onVirtualScrollEvt:Q}=ye({virtualScrollLength:u,getVirtualScrollTarget:S,getVirtualScrollEl:R}),V=b(()=>{if(u.value===0)return[];const a=(r,f)=>({index:n.value.from+f,item:r});return e.itemsFn===void 0?e.items.slice(n.value.from,n.value.to).map(a):e.itemsFn(n.value.from,n.value.to-n.value.from).map(a)}),y=b(()=>"q-virtual-scroll q-virtual-scroll"+(e.virtualScrollHorizontal===!0?"--horizontal":"--vertical")+(e.scrollTarget!==void 0?"":" scroll")),F=b(()=>e.scrollTarget!==void 0?{}:{tabindex:0});A(u,()=>{g()}),A(()=>e.scrollTarget,()=>{T(),C()});function R(){return s.value.$el||s.value}function S(){return o}function C(){o=se(R(),e.scrollTarget),o.addEventListener("scroll",Q,I.passive)}function T(){o!==void 0&&(o.removeEventListener("scroll",Q,I.passive),o=void 0)}function c(){let a=w(e.type==="list"?"div":"tbody",V.value.map(i.default));return i.before!==void 0&&(a=i.before().concat(a)),ae(i.after,a)}return j(()=>{g()}),W(()=>{C()}),ee(()=>{C()}),te(()=>{T()}),le(()=>{T()}),()=>{if(i.default===void 0){console.error("QVirtualScroll: default scoped slot is required for rendering");return}return e.type==="__qtable"?ut({ref:s,class:"q-table__middle "+y.value},c()):$(dt[e.type],{...d,ref:s,class:[d.class,y.value],...F.value},c)}}});const mt={key:0,class:"q-pt-md text-center"},ht={key:1,class:"absolute-center items-center"},_t={class:"row"},gt={key:2,class:"absolute-center items-center"},pt={class:"row"},bt={class:"q-px-md q-pb-xs q-gutter-md"},yt="Filter 1 Month from 2021.12.19",At=J({__name:"Refuels",props:{id:{type:Number}},setup(e){const i=e,d=oe(),o=_e(),s=he(),u=x(new G),n=x(s.refuelFilterActive),g=s.selectedVehicleId,w=x(""),Q=x(!0),V=x(null);let y=x(0);function F(){U.create(JSON.stringify(S.value))}function R(){U.create(JSON.stringify(o.refuels))}let S=b(()=>[...o.refuels].sort((c,a)=>a.date.getTime()-c.date.getTime()));function C(c,a){const r=[];for(let f=0;f<a;f++)r.push(S.value[c+f]);return Object.freeze(r)}function T(){s.toggleRefuelFilter(!1),n.value=!1}return B.on("showRefuelOptionsDialog",c=>ve([{text:"Edit",icon:"edit",action:()=>{d.push({path:`/refuels/edit/${c}`,params:{id:c}})}},{text:"Delete",icon:"delete",action:()=>me("Delete refuel entry?",a=>{(async()=>await o.deleteRefuel(a).then(async()=>{var r;return await o.readRefuels((r=s.selectedVehicleId)!=null?r:0)}))()},c)}])),j(async()=>{var c,a,r;B.emit("updateTitle","Refuels"),w.value=s.plateNumberInTitleActive?s.selectedVehiclePlateNumber:s.selectedVehicleName,await o.readRefuels((c=s.selectedVehicleId)!=null?c:0),u.value=(r=await o.getVehicle((a=s.selectedVehicleId)!=null?a:0))!=null?r:u.value,i.id&&i.id>0&&(y.value=o.refuels.sort((f,K)=>K.date.getTime()-f.date.getTime()).findIndex(f=>f.id==i.id)),y.value<0&&(y.value=0),Q.value=!1,V.value.scrollTo(y.value)}),ie(()=>{B.off("showRefuelOptionsDialog")}),(c,a)=>(_(),D(ue,null,{default:h(()=>[m(g)&&n.value?(_(),k("div",mt,[l(q,{class:"q-pa-xs",style:{color:"pink"},flat:"","no-caps":"",label:" ",onClick:T,"icon-right":"delete_outline"},{default:h(()=>[z(v(yt))]),_:1})])):ne("",!0),m(g)&&m(S).length===0?(_(),k("div",ht,[t("div",_t,[l(M,{class:"col",name:"img:local_gas_station.svg",size:"100px"})]),l(q,{color:"accent",label:"Add refuel","icon-right":"add",unelevated:"","no-caps":"",outline:"",onClick:a[0]||(a[0]=r=>m(d).push("/refuels/add"))})])):m(g)?(_(),k(re,{key:3},[t("div",bt,[l(ce,{align:"top"},{default:h(()=>[z(v(w.value),1)]),_:1})]),l(m(vt),{ref_key:"virtualListRef",ref:V,style:{"max-height":"90vh","overflow-x":"hidden"},"items-size":m(S).length,"items-fn":C,"virtual-scroll-item-size":200,"virtual-scroll-slice-ratio-before":"1","virtual-scroll-slice-ratio-after":"4"},{default:h(({item:r,index:f})=>[(_(),D(nt,{key:f,refuel:r,vehicle:u.value,fuelConsumption:m(ge)(u.value,r.id).toFixed(2),loading:Q.value,class:"q-pt-md q-pl-md q-pr-md"},null,8,["refuel","vehicle","fuelConsumption","loading"]))]),_:1},8,["items-size"])],64)):(_(),k("div",gt,[t("div",pt,[l(M,{class:"col",name:"img:local_gas_station.svg",size:"100px"})]),l(q,{color:"accent",label:"Add vehicle","icon-right":"add",unelevated:"","no-caps":"",outline:"",onClick:a[1]||(a[1]=r=>m(d).push("/vehicles/add"))})])),l(q,{onClick:F},{default:h(()=>[z("Show refuels")]),_:1}),l(q,{onClick:R},{default:h(()=>[z("Show store")]),_:1})]),_:1}))}});export{At as default};
