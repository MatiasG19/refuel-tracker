import{u as z,G as U,I as M,c as b,h as $,v as E,g as L,$ as j,a1 as h,ac as k,f as a,a3 as g,ax as O,ag as t,aw as P,d as Y,ae as K,a2 as R,a8 as m,ah as v,ab as V,r as q,w as A,aB as H,o as W,aI as X,aJ as Z,y as ee,U as te,A as F,S as le,a9 as ae,a as se,a5 as I,a7 as N,a6 as ie,F as oe}from"./index.af9e0f6e.js";import{Q as ne}from"./QBadge.94d9d111.js";import{Q as re}from"./QPage.e5be6806.js";import{R as ce,V as G}from"./dexie.e9b82229.js";import{d as de}from"./date.a0df01d2.js";import{emitter as C}from"./mitt.4e333a4b.js";import{o as ue}from"./index.bf534033.js";import{c as ve}from"./index.6063ef0a.js";import{u as fe}from"./settingsStore.5309004a.js";import{u as me}from"./refuelStore.e71e446b.js";import{v as he}from"./fuelConsumption.8f4bd1ed.js";import{Q as _e}from"./QList.27091de1.js";import{u as ge,a as pe}from"./use-virtual-scroll.52cd128c.js";import{u as be}from"./refuelFilterStore.f430f297.js";import"./format.c860d4da.js";import"./QSpace.2d3c42d6.js";import"./ClosePopup.15002a59.js";import"./i18n.a8414de4.js";const ye=["text","rect","circle","QBtn","QBadge","QChip","QToolbar","QCheckbox","QRadio","QToggle","QSlider","QRange","QInput","QAvatar"],xe=["wave","pulse","pulse-x","pulse-y","fade","blink","none"];var _=z({name:"QSkeleton",props:{...U,tag:{type:String,default:"div"},type:{type:String,validator:e=>ye.includes(e),default:"rect"},animation:{type:String,validator:e=>xe.includes(e),default:"wave"},animationSpeed:{type:[String,Number],default:1500},square:Boolean,bordered:Boolean,size:String,width:String,height:String},setup(e,{slots:n}){const c=L(),i=M(e,c.proxy.$q),o=b(()=>{const d=e.size!==void 0?[e.size,e.size]:[e.width,e.height];return{"--q-skeleton-speed":`${e.animationSpeed}ms`,width:d[0],height:d[1]}}),f=b(()=>`q-skeleton q-skeleton--${i.value===!0?"dark":"light"} q-skeleton--type-${e.type}`+(e.animation!=="none"?` q-skeleton--anim q-skeleton--anim-${e.animation}`:"")+(e.square===!0?" q-skeleton--square":"")+(e.bordered===!0?" q-skeleton--bordered":""));return()=>$(e.tag,{class:f.value,style:o.value},E(n.default))}});const Se={},qe={class:"row"},ke={class:"col-3"},$e={class:"row"},Te={class:"col-2"},we={class:"text-h5"},Qe={class:"text-subtitle1"},Ve=t("div",{class:"col-1"},null,-1),Ce={class:"col-2"},Re={class:"text-h5"},Be={class:"text-subtitle1"},De=t("div",{class:"col-1"},null,-1),ze={class:"col-2"},Ae={class:"text-h5"},Fe={class:"text-subtitle1"},Ie=t("div",{class:"col-1"},null,-1),Ne={class:"col-2"},Ue={class:"text-h5"},Me={class:"text-subtitle1"};function Ee(e,n){return h(),k("div",null,[a(P,null,{default:g(()=>[a(O,null,{default:g(()=>[t("div",qe,[t("div",ke,[a(_,{type:"text"})])]),t("div",$e,[t("div",Te,[t("div",we,[a(_,{type:"text"})]),t("div",Qe,[a(_,{type:"text"})])]),Ve,t("div",Ce,[t("div",Re,[a(_,{type:"text"})]),t("div",Be,[a(_,{type:"text"})])]),De,t("div",ze,[t("div",Ae,[a(_,{type:"text"})]),t("div",Fe,[a(_,{type:"text"})])]),Ie,t("div",Ne,[t("div",Ue,[a(_,{type:"text"})]),t("div",Me,[a(_,{type:"text"})])])])]),_:1})]),_:1})])}var Le=j(Se,[["render",Ee]]);const Oe={class:"row items-center no-wrap"},Pe={class:"col"},Ye={class:"text-subtitle2"},He={class:"col-auto space-station"},Ge={class:"row"},Je={class:"col-3"},je={class:"text-h5 accent-space-station"},Ke={class:"text-subtitle1"},We={class:"col-3"},Xe={class:"text-h5 accent-space-station"},Ze={class:"text-subtitle1"},et={class:"col-3"},tt={class:"text-h5 accent-space-station"},lt={class:"text-subtitle1"},at={class:"col-3"},st={class:"text-h5 accent-space-station"},it={class:"text-subtitle1"},ot=Y({__name:"RefuelCard",props:{refuel:{type:ce,required:!0},vehicle:{type:G,required:!0},fuelConsumption:{type:String,required:!0},loading:{type:Boolean}},setup(e){const n=e,c=de.formatDate(n.refuel.date,"YYYY-MMM-DD HH:mm");return(i,o)=>(h(),k("div",null,[a(K,{name:"fadein"},{default:g(()=>[e.loading?(h(),R(Le,{key:1})):(h(),R(P,{key:0,class:"space-station"},{default:g(()=>[a(O,null,{default:g(()=>{var f,d,p;return[t("div",Oe,[t("div",Pe,[t("div",Ye,m(v(c)),1)]),t("div",He,[a(V,{dense:"",round:"",flat:"",icon:"more_vert",onClick:o[0]||(o[0]=T=>v(C).emit("showRefuelOptionsDialog",e.refuel.id))})])]),t("div",Ge,[t("div",Je,[t("div",je,m(e.fuelConsumption),1),t("div",Ke,m((f=e.vehicle.fuelUnit)==null?void 0:f.fuelConsumptionUnit),1)]),t("div",We,[t("div",Xe,m(e.refuel.distanceDriven),1),t("div",Ze,m((d=e.vehicle.fuelUnit)==null?void 0:d.distanceUnit),1)]),t("div",et,[t("div",tt,m(e.refuel.payedAmount),1),t("div",lt,m(e.vehicle.currencyUnit),1)]),t("div",at,[t("div",st,m(e.refuel.refueledAmount),1),t("div",it,m((p=e.vehicle.fuelUnit)==null?void 0:p.fuelUnit),1)])])]}),_:1})]),_:1}))]),_:1})]))}}),nt=["horizontal","vertical","cell","none"];var rt=z({name:"QMarkupTable",props:{...U,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:e=>nt.includes(e)}},setup(e,{slots:n}){const c=L(),i=M(e,c.proxy.$q),o=b(()=>`q-markup-table q-table__container q-table__card q-table--${e.separator}-separator`+(i.value===!0?" q-table--dark q-table__card--dark q-dark":"")+(e.dense===!0?" q-table--dense":"")+(e.flat===!0?" q-table--flat":"")+(e.bordered===!0?" q-table--bordered":"")+(e.square===!0?" q-table--square":"")+(e.wrapCells===!1?" q-table--no-wrap":""));return()=>$("div",{class:o.value},[$("table",{class:"q-table"},E(n.default))])}});function ct(e,n){return $("div",e,[$("table",{class:"q-table"},n)])}const dt={list:_e,table:rt},ut=["list","table","__qtable"];var vt=z({name:"QVirtualScroll",props:{...ge,type:{type:String,default:"list",validator:e=>ut.includes(e)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:{default:void 0}},setup(e,{slots:n,attrs:c}){let i;const o=q(null),f=b(()=>e.itemsSize>=0&&e.itemsFn!==void 0?parseInt(e.itemsSize,10):Array.isArray(e.items)?e.items.length:0),{virtualScrollSliceRange:d,localResetVirtualScroll:p,padVirtualScroll:T,onVirtualScrollEvt:y}=pe({virtualScrollLength:f,getVirtualScrollTarget:B,getVirtualScrollEl:Q}),x=b(()=>{if(f.value===0)return[];const u=(D,J)=>({index:d.value.from+J,item:D});return e.itemsFn===void 0?e.items.slice(d.value.from,d.value.to).map(u):e.itemsFn(d.value.from,d.value.to-d.value.from).map(u)}),S=b(()=>"q-virtual-scroll q-virtual-scroll"+(e.virtualScrollHorizontal===!0?"--horizontal":"--vertical")+(e.scrollTarget!==void 0?"":" scroll")),w=b(()=>e.scrollTarget!==void 0?{}:{tabindex:0});A(f,()=>{p()}),A(()=>e.scrollTarget,()=>{l(),r()});function Q(){return o.value.$el||o.value}function B(){return i}function r(){i=te(Q(),e.scrollTarget),i.addEventListener("scroll",y,F.passive)}function l(){i!==void 0&&(i.removeEventListener("scroll",y,F.passive),i=void 0)}function s(){let u=T(e.type==="list"?"div":"tbody",x.value.map(n.default));return n.before!==void 0&&(u=n.before().concat(u)),le(n.after,u)}return H(()=>{p()}),W(()=>{r()}),X(()=>{r()}),Z(()=>{l()}),ee(()=>{l()}),()=>{if(n.default===void 0){console.error("QVirtualScroll: default scoped slot is required for rendering");return}return e.type==="__qtable"?ct({ref:o,class:"q-table__middle "+S.value},s()):$(dt[e.type],{...c,ref:o,class:[c.class,S.value],...w.value},s)}}});const ft={key:0,class:"absolute-center items-center"},mt={class:"row"},ht={key:1,class:"absolute-center items-center"},_t={class:"row"},gt={class:"q-px-md q-pb-xs q-gutter-md"},pt={key:0,class:"q-pt-md text-center"},It=Y({__name:"Refuels",props:{id:{type:Number}},setup(e){const n=ae(),c=me(),i=fe(),o=be(),f=q(new G),d=i.selectedVehicleId,p=q(""),T=q(!0),y=q(null);let x=q(0);const S=e;let w=b(()=>{let r=[];return o.filterActive?r=[...c.refuels].filter(l=>l.date.getTime()>=o.dateFrom.getTime()&&l.date.getTime()<=o.dateUntil.getTime()).sort((l,s)=>s.date.getTime()-l.date.getTime()):r=[...c.refuels].sort((l,s)=>s.date.getTime()-l.date.getTime()),r});function Q(r,l){const s=[];for(let u=0;u<l;u++)s.push(w.value[r+u]);return s}function B(){o.removeFilter()}return C.on("showRefuelOptionsDialog",r=>ue([{text:"Edit",icon:"edit",action:()=>{n.push({path:`/refuels/edit/${r}`,params:{id:r}})}},{text:"Delete",icon:"delete",action:()=>ve("Delete refuel entry?",l=>{(async()=>await c.deleteRefuel(l).then(async()=>{var s;return await c.readRefuels((s=i.selectedVehicleId)!=null?s:0)}))()},r)}])),H(async()=>{var r,l,s;C.emit("updateTitle","Refuels"),p.value=i.plateNumberInTitleActive?i.selectedVehiclePlateNumber:i.selectedVehicleName,await c.readRefuels((r=i.selectedVehicleId)!=null?r:0),f.value=(s=await c.getVehicle((l=i.selectedVehicleId)!=null?l:0))!=null?s:f.value,S.id&&S.id>0&&(x.value=c.refuels.sort((u,D)=>D.date.getTime()-u.date.getTime()).findIndex(u=>u.id==S.id)),x.value<0&&(x.value=0),T.value=!1,y.value&&y.value.scrollTo(x.value)}),se(()=>{C.off("showRefuelOptionsDialog")}),(r,l)=>(h(),R(re,null,{default:g(()=>[v(d)&&v(w).length===0&&!v(o).filterActive?(h(),k("div",ft,[t("div",mt,[a(I,{class:"col",name:"img:local_gas_station.svg",size:"100px"})]),a(V,{color:"accent",label:"Add refuel","icon-right":"add",unelevated:"","no-caps":"",outline:"",onClick:l[0]||(l[0]=s=>v(n).push("/refuels/add"))})])):v(d)?(h(),k(oe,{key:2},[t("div",gt,[a(ne,{align:"top"},{default:g(()=>[N(m(p.value),1)]),_:1})]),v(d)&&v(o).filterActive?(h(),k("div",pt,[a(V,{class:"q-pa-xs",style:{color:"pink"},flat:"","no-caps":"",label:" ",onClick:B,"icon-right":"delete_outline"},{default:g(()=>[N(m(v(o).filterName),1)]),_:1})])):ie("",!0),a(v(vt),{ref_key:"virtualListRef",ref:y,style:{"max-height":"90vh","overflow-x":"hidden"},"items-size":v(w).length,"items-fn":Q,"virtual-scroll-item-size":200,"virtual-scroll-slice-ratio-before":"4","virtual-scroll-slice-ratio-after":"4"},{default:g(({item:s,index:u})=>[(h(),R(ot,{key:u,refuel:s,vehicle:f.value,fuelConsumption:v(he)(f.value,s).toFixed(2),loading:T.value,class:"q-pt-md q-pl-md q-pr-md"},null,8,["refuel","vehicle","fuelConsumption","loading"]))]),_:1},8,["items-size"])],64)):(h(),k("div",ht,[t("div",_t,[a(I,{class:"col",name:"img:local_gas_station.svg",size:"100px"})]),a(V,{color:"accent",label:"Add vehicle","icon-right":"add",unelevated:"","no-caps":"",outline:"",onClick:l[1]||(l[1]=s=>v(n).push("/vehicles/add"))})]))]),_:1}))}});export{It as default};
