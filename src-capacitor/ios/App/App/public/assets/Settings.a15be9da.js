import{a as ct,b as gt,Q as st}from"./QItem.8815b672.js";import{n as It,_ as Dt,p as rt,d as $t,r as wt,o as Kt,a as Jt,a1 as Mt,ac as Gt,f as Oe,a3 as Ee,a6 as Nt,a7 as ft,bj as qt,ab as Bt,bk as Ct}from"./index.af9e0f6e.js";import{Q as St}from"./QList.27091de1.js";import"./CSelect.9df630b2.js";import{emitter as Yt}from"./mitt.4e333a4b.js";import{u as Qt}from"./settingsStore.5309004a.js";import{D as Fe,d as kt}from"./dexie.e9b82229.js";import{g as zt}from"./index.f4699e16.js";/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function it(d,b,u,m){function w(p){return p instanceof u?p:new u(function(o){o(p)})}return new(u||(u=Promise))(function(p,o){function B(_){try{s(m.next(_))}catch(F){o(F)}}function L(_){try{s(m.throw(_))}catch(F){o(F)}}function s(_){_.done?p(_.value):w(_.value).then(B,L)}s((m=m.apply(d,b||[])).next())})}function Xe(d,b){var u={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},m,w,p,o;return o={next:B(0),throw:B(1),return:B(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function B(s){return function(_){return L([s,_])}}function L(s){if(m)throw new TypeError("Generator is already executing.");for(;u;)try{if(m=1,w&&(p=s[0]&2?w.return:s[0]?w.throw||((p=w.return)&&p.call(w),0):w.next)&&!(p=p.call(w,s[1])).done)return p;switch(w=0,p&&(s=[s[0]&2,p.value]),s[0]){case 0:case 1:p=s;break;case 4:return u.label++,{value:s[1],done:!1};case 5:u.label++,w=s[1],s=[0];continue;case 7:s=u.ops.pop(),u.trys.pop();continue;default:if(p=u.trys,!(p=p.length>0&&p[p.length-1])&&(s[0]===6||s[0]===2)){u=0;continue}if(s[0]===3&&(!p||s[1]>p[0]&&s[1]<p[3])){u.label=s[1];break}if(s[0]===6&&u.label<p[1]){u.label=p[1],p=s;break}if(p&&u.label<p[2]){u.label=p[2],u.ops.push(s);break}p[2]&&u.ops.pop(),u.trys.pop();continue}s=b.call(d,u)}catch(_){s=[6,_],w=0}finally{m=p=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}}function Ht(d){var b=[d.schema.primKey].concat(d.schema.indexes);return b.map(function(u){return u.src}).join(",")}function Wt(d){for(var b={},u=0,m=d.tables;u<m.length;u++){var w=m[u];b[w.name]=w.schema}return b}function xt(d,b){return new Promise(function(u,m){var w=new FileReader;w.onabort=function(p){return m(new Error("file read aborted"))},w.onerror=function(p){return m(p.target.error)},w.onload=function(p){return u(p.target.result)},b==="binary"?w.readAsArrayBuffer(d):w.readAsText(d)})}function jt(d,b){if(typeof FileReaderSync=="undefined")throw new Error("FileReaderSync missing. Reading blobs synchronously requires code to run from within a web worker. Use TSON.encapsulateAsync() to do it from the main thread.");var u=new FileReaderSync,m=b==="binary"?u.readAsArrayBuffer(d):u.readAsText(d);return m}var Ot=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Et(d,b){return b={exports:{}},d(b,b.exports),b.exports}var vt=Et(function(d,b){(function(u,m){d.exports=m()})(Ot,function(){function u(f){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?u=function(y){return typeof y}:u=function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},u(f)}function m(f,y,h,v,O,G,H){try{var W=f[G](H),x=W.value}catch(Ae){h(Ae);return}W.done?y(x):Promise.resolve(x).then(v,O)}function w(f){return function(){var y=this,h=arguments;return new Promise(function(v,O){var G=f.apply(y,h);function H(x){m(G,v,O,H,W,"next",x)}function W(x){m(G,v,O,H,W,"throw",x)}H(void 0)})}}function p(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}function o(f,y){for(var h=0;h<y.length;h++){var v=y[h];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(f,v.key,v)}}function B(f,y,h){return y&&o(f.prototype,y),h&&o(f,h),f}function L(f,y,h){return y in f?Object.defineProperty(f,y,{value:h,enumerable:!0,configurable:!0,writable:!0}):f[y]=h,f}function s(f,y){var h=Object.keys(f);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(f);y&&(v=v.filter(function(O){return Object.getOwnPropertyDescriptor(f,O).enumerable})),h.push.apply(h,v)}return h}function _(f){for(var y=1;y<arguments.length;y++){var h=arguments[y]!=null?arguments[y]:{};y%2?s(Object(h),!0).forEach(function(v){L(f,v,h[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(h)):s(Object(h)).forEach(function(v){Object.defineProperty(f,v,Object.getOwnPropertyDescriptor(h,v))})}return f}function F(f,y){return k(f)||z(f,y)||me()}function he(f){return be(f)||K(f)||Ne()}function be(f){if(Array.isArray(f)){for(var y=0,h=new Array(f.length);y<f.length;y++)h[y]=f[y];return h}}function k(f){if(Array.isArray(f))return f}function K(f){if(Symbol.iterator in Object(f)||Object.prototype.toString.call(f)==="[object Arguments]")return Array.from(f)}function z(f,y){if(Symbol.iterator in Object(f)||Object.prototype.toString.call(f)==="[object Arguments]"){var h=[],v=!0,O=!1,G=void 0;try{for(var H=f[Symbol.iterator](),W;!(v=(W=H.next()).done)&&(h.push(W.value),!(y&&h.length===y));v=!0);}catch(x){O=!0,G=x}finally{try{!v&&H.return!=null&&H.return()}finally{if(O)throw G}}return h}}function Ne(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function me(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var N=function f(y){p(this,f),this.p=new Promise(y)};N.__typeson__type__="TypesonPromise",typeof Symbol!="undefined"&&(N.prototype[Symbol.toStringTag]="TypesonPromise"),N.prototype.then=function(f,y){var h=this;return new N(function(v,O){h.p.then(function(G){v(f?f(G):G)}).catch(function(G){return y?y(G):Promise.reject(G)}).then(v,O)})},N.prototype.catch=function(f){return this.then(null,f)},N.resolve=function(f){return new N(function(y){y(f)})},N.reject=function(f){return new N(function(y,h){h(f)})},["all","race"].forEach(function(f){N[f]=function(y){return new N(function(h,v){Promise[f](y.map(function(O){return O&&O.constructor&&O.constructor.__typeson__type__==="TypesonPromise"?O.p:O})).then(h,v)})}});var Ce={},D=Ce.toString,ne={}.hasOwnProperty,re=Object.getPrototypeOf,Pe=ne.toString;function c(f,y){return M(f)&&typeof f.then=="function"&&(!y||typeof f.catch=="function")}function r(f){return D.call(f).slice(8,-1)}function g(f,y){if(!f||u(f)!=="object")return!1;var h=re(f);if(!h)return y===null;var v=ne.call(h,"constructor")&&h.constructor;return typeof v!="function"?y===null:y===v||y!==null&&Pe.call(v)===Pe.call(y)||typeof y=="function"&&typeof v.__typeson__type__=="string"&&v.__typeson__type__===y.__typeson__type__}function l(f){if(!f||r(f)!=="Object")return!1;var y=re(f);return y?g(f,Object):!0}function ee(f){if(!f||r(f)!=="Object")return!1;var y=re(f);return y?g(f,Object)||ee(y):!0}function M(f){return f&&u(f)==="object"}function ie(f){return f.replace(/~/g,"~0").replace(/\./g,"~1")}function de(f){return f.replace(/~1/g,".").replace(/~0/g,"~")}function Te(f,y){if(y==="")return f;var h=y.indexOf(".");if(h>-1){var v=f[de(y.slice(0,h))];return v===void 0?void 0:Te(v,y.slice(h+1))}return f[de(y)]}function xe(f,y,h){if(y==="")return h;var v=y.indexOf(".");if(v>-1){var O=f[de(y.slice(0,v))];return xe(O,y.slice(v+1),h)}return f[de(y)]=h,f}function Be(f){return f===null?"null":Array.isArray(f)?"array":u(f)}var ce=Object.keys,ve=Array.isArray,je={}.hasOwnProperty,qe=["type","replaced","iterateIn","iterateUnsetNumeric"];function $(f,y){if(f.keypath==="")return-1;var h=f.keypath.match(/\./g)||0,v=y.keypath.match(/\./g)||0;return h&&(h=h.length),v&&(v=v.length),h>v?-1:h<v?1:f.keypath<y.keypath?-1:f.keypath>y.keypath}var pe=function(){function f(y){p(this,f),this.options=y,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return B(f,[{key:"stringify",value:function(h,v,O,G){G=_({},this.options,{},G,{stringification:!0});var H=this.encapsulate(h,null,G);return ve(H)?JSON.stringify(H[0],v,O):H.then(function(W){return JSON.stringify(W,v,O)})}},{key:"stringifySync",value:function(h,v,O,G){return this.stringify(h,v,O,_({throwOnBadSyncType:!0},G,{sync:!0}))}},{key:"stringifyAsync",value:function(h,v,O,G){return this.stringify(h,v,O,_({throwOnBadSyncType:!0},G,{sync:!1}))}},{key:"parse",value:function(h,v,O){return O=_({},this.options,{},O,{parse:!0}),this.revive(JSON.parse(h,v),O)}},{key:"parseSync",value:function(h,v,O){return this.parse(h,v,_({throwOnBadSyncType:!0},O,{sync:!0}))}},{key:"parseAsync",value:function(h,v,O){return this.parse(h,v,_({throwOnBadSyncType:!0},O,{sync:!1}))}},{key:"specialTypeNames",value:function(h,v){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return O.returnTypeNames=!0,this.encapsulate(h,v,O)}},{key:"rootTypeName",value:function(h,v){var O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return O.iterateNone=!0,this.encapsulate(h,v,O)}},{key:"encapsulate",value:function(h,v,O){O=_({sync:!0},this.options,{},O);var G=O,H=G.sync,W=this,x={},Ae=[],Re=[],Ve=[],Ye="cyclic"in O?O.cyclic:!0,Qe=O,Ze=Qe.encapsulateObserver,De=se("",h,Ye,v||{},Ve);function ze(P){var n=Object.values(x);if(O.iterateNone)return n.length?n[0]:f.getJSONType(P);if(n.length){if(O.returnTypeNames)return he(new Set(n));!P||!l(P)||je.call(P,"$types")?P={$:P,$types:{$:x}}:P.$types=x}else M(P)&&je.call(P,"$types")&&(P={$:P,$types:!0});return O.returnTypeNames?!1:P}function ge(P,n){return oe.apply(this,arguments)}function oe(){return oe=w(regeneratorRuntime.mark(function P(n,e){var t;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.all(e.map(function(S){return S[1].p}));case 2:return t=a.sent,a.next=5,Promise.all(t.map(function(){var S=w(regeneratorRuntime.mark(function A(I){var E,U,q,Y,ae,Z,X,fe,le,J,_e,C,T,R;return regeneratorRuntime.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(E=[],U=e.splice(0,1),q=F(U,1),Y=q[0],ae=F(Y,7),Z=ae[0],X=ae[2],fe=ae[3],le=ae[4],J=ae[5],_e=ae[6],C=se(Z,I,X,fe,E,!0,_e),T=g(C,N),!(Z&&T)){V.next=11;break}return V.next=8,C.p;case 8:return R=V.sent,le[J]=R,V.abrupt("return",ge(n,E));case 11:return Z?le[J]=C:T?n=C.p:n=C,V.abrupt("return",ge(n,E));case 13:case"end":return V.stop()}},A)}));return function(A){return S.apply(this,arguments)}}()));case 5:return a.abrupt("return",n);case 6:case"end":return a.stop()}},P)})),oe.apply(this,arguments)}function te(P,n,e){Object.assign(P,n);var t=qe.map(function(i){var a=P[i];return delete P[i],a});e(),qe.forEach(function(i,a){P[i]=t[a]})}function se(P,n,e,t,i,a,S){var A,I={},E=u(n),U=Ze?function(T){var R=S||t.type||f.getJSONType(n);Ze(Object.assign(T||I,{keypath:P,value:n,cyclic:e,stateObj:t,promisesData:i,resolvingTypesonPromise:a,awaitingTypesonPromise:g(n,N)},{type:R}))}:null;if(["string","boolean","number","undefined"].includes(E))return n===void 0||E==="number"&&(isNaN(n)||n===-1/0||n===1/0)?(t.replaced?A=n:A=we(P,n,t,i,!1,a,U),A!==n&&(I={replaced:A})):A=n,U&&U(),A;if(n===null)return U&&U(),n;if(e&&!t.iterateIn&&!t.iterateUnsetNumeric&&n&&u(n)==="object"){var q=Ae.indexOf(n);if(q<0)e===!0&&(Ae.push(n),Re.push(P));else return x[P]="#",U&&U({cyclicKeypath:Re[q]}),"#"+Re[q]}var Y=l(n),ae=ve(n),Z=(Y||ae)&&(!W.plainObjectReplacers.length||t.replaced)||t.iterateIn?n:we(P,n,t,i,Y||ae,null,U),X;if(Z!==n?(A=Z,I={replaced:Z}):P===""&&g(n,N)?(i.push([P,n,e,t,void 0,void 0,t.type]),A=n):ae&&t.iterateIn!=="object"||t.iterateIn==="array"?(X=new Array(n.length),I={clone:X}):!["function","symbol"].includes(u(n))&&!("toJSON"in n)&&!g(n,N)&&!g(n,Promise)&&!g(n,ArrayBuffer)||Y||t.iterateIn==="object"?(X={},t.addLength&&(X.length=n.length),I={clone:X}):A=n,U&&U(),O.iterateNone)return X||A;if(!X)return A;if(t.iterateIn){var fe=function(R){var j={ownKeys:je.call(n,R)};te(t,j,function(){var V=P+(P?".":"")+ie(R),Q=se(V,n[R],Boolean(e),t,i,a);g(Q,N)?i.push([V,Q,Boolean(e),t,X,R,t.type]):Q!==void 0&&(X[R]=Q)})};for(var le in n)fe(le);U&&U({endIterateIn:!0,end:!0})}else ce(n).forEach(function(T){var R=P+(P?".":"")+ie(T),j={ownKeys:!0};te(t,j,function(){var V=se(R,n[T],Boolean(e),t,i,a);g(V,N)?i.push([R,V,Boolean(e),t,X,T,t.type]):V!==void 0&&(X[T]=V)})}),U&&U({endIterateOwn:!0,end:!0});if(t.iterateUnsetNumeric){for(var J=n.length,_e=function(R){if(!(R in n)){var j=P+(P?".":"")+R,V={ownKeys:!1};te(t,V,function(){var Q=se(j,void 0,Boolean(e),t,i,a);g(Q,N)?i.push([j,Q,Boolean(e),t,X,R,t.type]):Q!==void 0&&(X[R]=Q)})}},C=0;C<J;C++)_e(C);U&&U({endIterateUnsetNumeric:!0,end:!0})}return X}function we(P,n,e,t,i,a,S){for(var A=i?W.plainObjectReplacers:W.nonplainObjectReplacers,I=A.length;I--;){var E=A[I];if(E.test(n,e)){var U=E.type;if(W.revivers[U]){var q=x[P];x[P]=q?[U].concat(q):U}if(Object.assign(e,{type:U,replaced:!0}),(H||!E.replaceAsync)&&!E.replace)return S&&S({typeDetected:!0}),se(P,n,Ye&&"readonly",e,t,a,U);S&&S({replacing:!0});var Y=H||!E.replaceAsync?"replace":"replaceAsync";return se(P,E[Y](n,e),Ye&&"readonly",e,t,a,U)}}return n}return Ve.length?H&&O.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(ge(De,Ve)).then(ze):!H&&O.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():O.stringification&&H?[ze(De)]:H?ze(De):Promise.resolve(ze(De))}},{key:"encapsulateSync",value:function(h,v,O){return this.encapsulate(h,v,_({throwOnBadSyncType:!0},O,{sync:!0}))}},{key:"encapsulateAsync",value:function(h,v,O){return this.encapsulate(h,v,_({throwOnBadSyncType:!0},O,{sync:!1}))}},{key:"revive",value:function(h,v){var O=h&&h.$types;if(!O)return h;if(O===!0)return h.$;v=_({sync:!0},this.options,{},v);var G=v,H=G.sync,W=[],x={},Ae=!0;O.$&&l(O.$)&&(h=h.$,O=O.$,Ae=!1);var Re=this;function Ve(oe,te){var se=Re.revivers[oe]||[],we=F(se,1),P=we[0];if(!P)throw new Error("Unregistered type: "+oe);return H&&!("revive"in P)?te:P[H&&P.revive?"revive":!H&&P.reviveAsync?"reviveAsync":"revive"](te,x)}function Ye(){var oe=[];if(Object.entries(O).forEach(function(te){var se=F(te,2),we=se[0],P=se[1];P!=="#"&&[].concat(P).forEach(function(n){var e=Re.revivers[n]||[null,{}],t=F(e,2),i=t[1].plain;!i||(oe.push({keypath:we,type:n}),delete O[we])})}),!!oe.length)return oe.sort($).reduce(function te(se,we){var P=we.keypath,n=we.type;if(c(se))return se.then(function(i){return te(i,{keypath:P,type:n})});var e=Te(h,P);if(e=Ve(n,e),g(e,N))return e.then(function(i){var a=xe(h,P,i);a===i&&(h=a)});var t=xe(h,P,e);t===e&&(h=t)},void 0)}var Qe=[];function Ze(oe,te,se,we,P){if(!(Ae&&oe==="$types")){var n=O[oe],e=ve(te);if(e||l(te)){var t=e?new Array(te.length):{};for(ce(te).forEach(function(q){var Y=Ze(oe+(oe?".":"")+ie(q),te[q],se||t,t,q),ae=function(X){return g(X,Le)?t[q]=void 0:X!==void 0&&(t[q]=X),X};g(Y,N)?Qe.push(Y.then(function(Z){return ae(Z)})):ae(Y)}),te=t;W.length;){var i=F(W[0],4),a=i[0],S=i[1],A=i[2],I=i[3],E=Te(a,S);if(E!==void 0)A[I]=E;else break;W.splice(0,1)}}if(!n)return te;if(n==="#"){var U=Te(se,te.slice(1));return U===void 0&&W.push([se,te.slice(1),we,P]),U}return[].concat(n).reduce(function q(Y,ae){return g(Y,N)?Y.then(function(Z){return q(Z,ae)}):Ve(ae,Y)},te)}}function De(oe){return g(oe,Le)?void 0:oe}var ze=Ye(),ge;return g(ze,N)?ge=ze.then(function(){return h}):(ge=Ze("",h,null),Qe.length&&(ge=N.resolve(ge).then(function(oe){return N.all([oe].concat(Qe))}).then(function(oe){var te=F(oe,1),se=te[0];return se}))),c(ge)?H&&v.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():g(ge,N)?ge.p.then(De):ge:!H&&v.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():H?De(ge):Promise.resolve(De(ge))}},{key:"reviveSync",value:function(h,v){return this.revive(h,_({throwOnBadSyncType:!0},v,{sync:!0}))}},{key:"reviveAsync",value:function(h,v){return this.revive(h,_({throwOnBadSyncType:!0},v,{sync:!1}))}},{key:"register",value:function(h,v){return v=v||{},[].concat(h).forEach(function O(G){var H=this;if(ve(G))return G.map(function(W){return O.call(H,W)});G&&ce(G).forEach(function(W){if(W==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(f.JSON_TYPES.includes(W))throw new TypeError("Plain JSON object types are reserved as type names");var x=G[W],Ae=x&&x.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,Re=Ae.filter(function(se){return se.type===W});if(Re.length&&(Ae.splice(Ae.indexOf(Re[0]),1),delete this.revivers[W],delete this.types[W]),typeof x=="function"){var Ve=x;x={test:function(we){return we&&we.constructor===Ve},replace:function(we){return _({},we)},revive:function(we){return Object.assign(Object.create(Ve.prototype),we)}}}else if(ve(x)){var Ye=x,Qe=F(Ye,3),Ze=Qe[0],De=Qe[1],ze=Qe[2];x={test:Ze,replace:De,revive:ze}}if(!(!x||!x.test)){var ge={type:W,test:x.test.bind(x)};x.replace&&(ge.replace=x.replace.bind(x)),x.replaceAsync&&(ge.replaceAsync=x.replaceAsync.bind(x));var oe=typeof v.fallback=="number"?v.fallback:v.fallback?0:1/0;if(x.testPlainObjects?this.plainObjectReplacers.splice(oe,0,ge):this.nonplainObjectReplacers.splice(oe,0,ge),x.revive||x.reviveAsync){var te={};x.revive&&(te.revive=x.revive.bind(x)),x.reviveAsync&&(te.reviveAsync=x.reviveAsync.bind(x)),this.revivers[W]=[te,{plain:x.testPlainObjects}]}this.types[W]=x}},this)},this),this}}]),f}(),Le=function f(){p(this,f)};return Le.__typeson__type__="TypesonUndefined",pe.Undefined=Le,pe.Promise=N,pe.isThenable=c,pe.toStringTag=r,pe.hasConstructorOf=g,pe.isObject=M,pe.isPlainObject=l,pe.isUserObject=ee,pe.escapeKeyPathComponent=ie,pe.unescapeKeyPathComponent=de,pe.getByKeyPath=Te,pe.getJSONType=Be,pe.JSON_TYPES=["null","boolean","number","string","array","object"],pe})}),Xt=Et(function(d,b){(function(u,m){d.exports=m()})(Ot,function(){function u(n){return(u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(n)}function m(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function w(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function p(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function o(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function B(n){return function(t){if(Array.isArray(t))return L(t)}(n)||function(t){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(t))return Array.from(t)}(n)||function(t,i){if(!!t){if(typeof t=="string")return L(t,i);var a=Object.prototype.toString.call(t).slice(8,-1);if(a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set")return Array.from(t);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return L(t,i)}}(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function L(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}function s(n){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(n)}function _(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function F(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function he(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function be(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),t.push.apply(t,i)}return t}function k(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?be(Object(t),!0).forEach(function(i){he(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):be(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function K(n,e){return function(i){if(Array.isArray(i))return i}(n)||function(i,a){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(i)))){var S=[],A=!0,I=!1,E=void 0;try{for(var U,q=i[Symbol.iterator]();!(A=(U=q.next()).done)&&(S.push(U.value),!a||S.length!==a);A=!0);}catch(Y){I=!0,E=Y}finally{try{A||q.return==null||q.return()}finally{if(I)throw E}}return S}}(n,e)||Ne(n,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function z(n){return function(t){if(Array.isArray(t))return me(t)}(n)||function(t){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(t))return Array.from(t)}(n)||Ne(n)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ne(n,e){if(n){if(typeof n=="string")return me(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?me(n,e):void 0}}function me(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,i=new Array(e);t<e;t++)i[t]=n[t];return i}var N=function n(e){_(this,n),this.p=new Promise(e)};N.__typeson__type__="TypesonPromise",typeof Symbol!="undefined"&&(N.prototype[Symbol.toStringTag]="TypesonPromise"),N.prototype.then=function(n,e){var t=this;return new N(function(i,a){t.p.then(function(S){i(n?n(S):S)}).catch(function(S){return e?e(S):Promise.reject(S)}).then(i,a)})},N.prototype.catch=function(n){return this.then(null,n)},N.resolve=function(n){return new N(function(e){e(n)})},N.reject=function(n){return new N(function(e,t){t(n)})},["all","race"].forEach(function(n){N[n]=function(e){return new N(function(t,i){Promise[n](e.map(function(a){return a&&a.constructor&&a.constructor.__typeson__type__==="TypesonPromise"?a.p:a})).then(t,i)})}});var Ce={}.toString,D={}.hasOwnProperty,ne=Object.getPrototypeOf,re=D.toString;function Pe(n,e){return l(n)&&typeof n.then=="function"&&(!e||typeof n.catch=="function")}function c(n){return Ce.call(n).slice(8,-1)}function r(n,e){if(!n||s(n)!=="object")return!1;var t=ne(n);if(!t)return e===null;var i=D.call(t,"constructor")&&t.constructor;return typeof i!="function"?e===null:e===i||e!==null&&re.call(i)===re.call(e)||typeof e=="function"&&typeof i.__typeson__type__=="string"&&i.__typeson__type__===e.__typeson__type__}function g(n){return!(!n||c(n)!=="Object")&&(!ne(n)||r(n,Object))}function l(n){return n&&s(n)==="object"}function ee(n){return n.replace(/~/g,"~0").replace(/\./g,"~1")}function M(n){return n.replace(/~1/g,".").replace(/~0/g,"~")}function ie(n,e){if(e==="")return n;var t=e.indexOf(".");if(t>-1){var i=n[M(e.slice(0,t))];return i===void 0?void 0:ie(i,e.slice(t+1))}return n[M(e)]}function de(n,e,t){if(e==="")return t;var i=e.indexOf(".");return i>-1?de(n[M(e.slice(0,i))],e.slice(i+1),t):(n[M(e)]=t,n)}function Te(n,e,t){return t?e?e(n):n:(n&&n.then||(n=Promise.resolve(n)),e?n.then(e):n)}var xe=Object.keys,Be=Array.isArray,ce={}.hasOwnProperty,ve=["type","replaced","iterateIn","iterateUnsetNumeric"];function je(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(n.apply(this,e))}catch(i){return Promise.reject(i)}}}function qe(n,e){if(n.keypath==="")return-1;var t=n.keypath.match(/\./g)||0,i=e.keypath.match(/\./g)||0;return t&&(t=t.length),i&&(i=i.length),t>i?-1:t<i?1:n.keypath<e.keypath?-1:n.keypath>e.keypath}var $=function(){function n(e){_(this,n),this.options=e,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return function(t,i,a){return i&&F(t.prototype,i),a&&F(t,a),t}(n,[{key:"stringify",value:function(t,i,a,S){S=k(k(k({},this.options),S),{},{stringification:!0});var A=this.encapsulate(t,null,S);return Be(A)?JSON.stringify(A[0],i,a):A.then(function(I){return JSON.stringify(I,i,a)})}},{key:"stringifySync",value:function(t,i,a,S){return this.stringify(t,i,a,k(k({throwOnBadSyncType:!0},S),{},{sync:!0}))}},{key:"stringifyAsync",value:function(t,i,a,S){return this.stringify(t,i,a,k(k({throwOnBadSyncType:!0},S),{},{sync:!1}))}},{key:"parse",value:function(t,i,a){return a=k(k(k({},this.options),a),{},{parse:!0}),this.revive(JSON.parse(t,i),a)}},{key:"parseSync",value:function(t,i,a){return this.parse(t,i,k(k({throwOnBadSyncType:!0},a),{},{sync:!0}))}},{key:"parseAsync",value:function(t,i,a){return this.parse(t,i,k(k({throwOnBadSyncType:!0},a),{},{sync:!1}))}},{key:"specialTypeNames",value:function(t,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return a.returnTypeNames=!0,this.encapsulate(t,i,a)}},{key:"rootTypeName",value:function(t,i){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return a.iterateNone=!0,this.encapsulate(t,i,a)}},{key:"encapsulate",value:function(t,i,a){var S=je(function(C,T){return Te(Promise.all(T.map(function(R){return R[1].p})),function(R){return Te(Promise.all(R.map(je(function(j){var V=!1,Q=[],$e=K(T.splice(0,1),1),Se=K($e[0],7),Ue=Se[0],Je=Se[2],ue=Se[3],Me=Se[4],ye=Se[5],Ke=Se[6],Ie=J(Ue,j,Je,ue,Q,!0,Ke),He=r(Ie,N);return function(bt,pt){var ot=bt();return ot&&ot.then?ot.then(pt):pt(ot)}(function(){if(Ue&&He)return Te(Ie.p,function(We){return Me[ye]=We,V=!0,S(C,Q)})},function(We){return V?We:(Ue?Me[ye]=Ie:C=He?Ie.p:Ie,S(C,Q))})}))),function(){return C})})}),A=(a=k(k({sync:!0},this.options),a)).sync,I=this,E={},U=[],q=[],Y=[],ae=!("cyclic"in a)||a.cyclic,Z=a.encapsulateObserver,X=J("",t,ae,i||{},Y);function fe(C){var T=Object.values(E);if(a.iterateNone)return T.length?T[0]:n.getJSONType(C);if(T.length){if(a.returnTypeNames)return z(new Set(T));C&&g(C)&&!ce.call(C,"$types")?C.$types=E:C={$:C,$types:{$:E}}}else l(C)&&ce.call(C,"$types")&&(C={$:C,$types:!0});return!a.returnTypeNames&&C}function le(C,T,R){Object.assign(C,T);var j=ve.map(function(V){var Q=C[V];return delete C[V],Q});R(),ve.forEach(function(V,Q){C[V]=j[Q]})}function J(C,T,R,j,V,Q,$e){var Se,Ue={},Je=s(T),ue=Z?function(tt){var ke=$e||j.type||n.getJSONType(T);Z(Object.assign(tt||Ue,{keypath:C,value:T,cyclic:R,stateObj:j,promisesData:V,resolvingTypesonPromise:Q,awaitingTypesonPromise:r(T,N)},{type:ke}))}:null;if(["string","boolean","number","undefined"].includes(Je))return T===void 0||Number.isNaN(T)||T===Number.NEGATIVE_INFINITY||T===Number.POSITIVE_INFINITY?(Se=j.replaced?T:_e(C,T,j,V,!1,Q,ue))!==T&&(Ue={replaced:Se}):Se=T,ue&&ue(),Se;if(T===null)return ue&&ue(),T;if(R&&!j.iterateIn&&!j.iterateUnsetNumeric&&T&&s(T)==="object"){var Me=U.indexOf(T);if(!(Me<0))return E[C]="#",ue&&ue({cyclicKeypath:q[Me]}),"#"+q[Me];R===!0&&(U.push(T),q.push(C))}var ye,Ke=g(T),Ie=Be(T),He=(Ke||Ie)&&(!I.plainObjectReplacers.length||j.replaced)||j.iterateIn?T:_e(C,T,j,V,Ke||Ie,null,ue);if(He!==T?(Se=He,Ue={replaced:He}):C===""&&r(T,N)?(V.push([C,T,R,j,void 0,void 0,j.type]),Se=T):Ie&&j.iterateIn!=="object"||j.iterateIn==="array"?(ye=new Array(T.length),Ue={clone:ye}):(["function","symbol"].includes(s(T))||"toJSON"in T||r(T,N)||r(T,Promise)||r(T,ArrayBuffer))&&!Ke&&j.iterateIn!=="object"?Se=T:(ye={},j.addLength&&(ye.length=T.length),Ue={clone:ye}),ue&&ue(),a.iterateNone)return ye||Se;if(!ye)return Se;if(j.iterateIn){var We=function(ke){var et={ownKeys:ce.call(T,ke)};le(j,et,function(){var at=C+(C?".":"")+ee(ke),yt=J(at,T[ke],Boolean(R),j,V,Q);r(yt,N)?V.push([at,yt,Boolean(R),j,ye,ke,j.type]):yt!==void 0&&(ye[ke]=yt)})};for(var bt in T)We(bt);ue&&ue({endIterateIn:!0,end:!0})}else xe(T).forEach(function(tt){var ke=C+(C?".":"")+ee(tt);le(j,{ownKeys:!0},function(){var et=J(ke,T[tt],Boolean(R),j,V,Q);r(et,N)?V.push([ke,et,Boolean(R),j,ye,tt,j.type]):et!==void 0&&(ye[tt]=et)})}),ue&&ue({endIterateOwn:!0,end:!0});if(j.iterateUnsetNumeric){for(var pt=T.length,ot=function(ke){if(!(ke in T)){var et=C+(C?".":"")+ke;le(j,{ownKeys:!1},function(){var at=J(et,void 0,Boolean(R),j,V,Q);r(at,N)?V.push([et,at,Boolean(R),j,ye,ke,j.type]):at!==void 0&&(ye[ke]=at)})}},mt=0;mt<pt;mt++)ot(mt);ue&&ue({endIterateUnsetNumeric:!0,end:!0})}return ye}function _e(C,T,R,j,V,Q,$e){for(var Se=V?I.plainObjectReplacers:I.nonplainObjectReplacers,Ue=Se.length;Ue--;){var Je=Se[Ue];if(Je.test(T,R)){var ue=Je.type;if(I.revivers[ue]){var Me=E[C];E[C]=Me?[ue].concat(Me):ue}return Object.assign(R,{type:ue,replaced:!0}),!A&&Je.replaceAsync||Je.replace?($e&&$e({replacing:!0}),J(C,Je[A||!Je.replaceAsync?"replace":"replaceAsync"](T,R),ae&&"readonly",R,j,Q,ue)):($e&&$e({typeDetected:!0}),J(C,T,ae&&"readonly",R,j,Q,ue))}}return T}return Y.length?A&&a.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(S(X,Y)).then(fe):!A&&a.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():a.stringification&&A?[fe(X)]:A?fe(X):Promise.resolve(fe(X))}},{key:"encapsulateSync",value:function(t,i,a){return this.encapsulate(t,i,k(k({throwOnBadSyncType:!0},a),{},{sync:!0}))}},{key:"encapsulateAsync",value:function(t,i,a){return this.encapsulate(t,i,k(k({throwOnBadSyncType:!0},a),{},{sync:!1}))}},{key:"revive",value:function(t,i){var a=t&&t.$types;if(!a)return t;if(a===!0)return t.$;var S=(i=k(k({sync:!0},this.options),i)).sync,A=[],I={},E=!0;a.$&&g(a.$)&&(t=t.$,a=a.$,E=!1);var U=this;function q(fe,le){var J=K(U.revivers[fe]||[],1)[0];if(!J)throw new Error("Unregistered type: "+fe);return S&&!("revive"in J)?le:J[S&&J.revive?"revive":!S&&J.reviveAsync?"reviveAsync":"revive"](le,I)}var Y=[];function ae(fe){return r(fe,pe)?void 0:fe}var Z,X=function(){var le=[];if(Object.entries(a).forEach(function(J){var _e=K(J,2),C=_e[0],T=_e[1];T!=="#"&&[].concat(T).forEach(function(R){K(U.revivers[R]||[null,{}],2)[1].plain&&(le.push({keypath:C,type:R}),delete a[C])})}),le.length)return le.sort(qe).reduce(function J(_e,C){var T=C.keypath,R=C.type;if(Pe(_e))return _e.then(function(Q){return J(Q,{keypath:T,type:R})});var j=ie(t,T);if(r(j=q(R,j),N))return j.then(function(Q){var $e=de(t,T,Q);$e===Q&&(t=$e)});var V=de(t,T,j);V===j&&(t=V)},void 0)}();return r(X,N)?Z=X.then(function(){return t}):(Z=function fe(le,J,_e,C,T){if(!E||le!=="$types"){var R=a[le],j=Be(J);if(j||g(J)){var V=j?new Array(J.length):{};for(xe(J).forEach(function(ye){var Ke=fe(le+(le?".":"")+ee(ye),J[ye],_e||V,V,ye),Ie=function(We){return r(We,pe)?V[ye]=void 0:We!==void 0&&(V[ye]=We),We};r(Ke,N)?Y.push(Ke.then(function(He){return Ie(He)})):Ie(Ke)}),J=V;A.length;){var Q=K(A[0],4),$e=Q[0],Se=Q[1],Ue=Q[2],Je=Q[3],ue=ie($e,Se);if(ue===void 0)break;Ue[Je]=ue,A.splice(0,1)}}if(!R)return J;if(R==="#"){var Me=ie(_e,J.slice(1));return Me===void 0&&A.push([_e,J.slice(1),C,T]),Me}return[].concat(R).reduce(function ye(Ke,Ie){return r(Ke,N)?Ke.then(function(He){return ye(He,Ie)}):q(Ie,Ke)},J)}}("",t,null),Y.length&&(Z=N.resolve(Z).then(function(fe){return N.all([fe].concat(Y))}).then(function(fe){return K(fe,1)[0]}))),Pe(Z)?S&&i.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():r(Z,N)?Z.p.then(ae):Z:!S&&i.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():S?ae(Z):Promise.resolve(ae(Z))}},{key:"reviveSync",value:function(t,i){return this.revive(t,k(k({throwOnBadSyncType:!0},i),{},{sync:!0}))}},{key:"reviveAsync",value:function(t,i){return this.revive(t,k(k({throwOnBadSyncType:!0},i),{},{sync:!1}))}},{key:"register",value:function(t,i){return i=i||{},[].concat(t).forEach(function a(S){var A=this;if(Be(S))return S.map(function(I){return a.call(A,I)});S&&xe(S).forEach(function(I){if(I==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(n.JSON_TYPES.includes(I))throw new TypeError("Plain JSON object types are reserved as type names");var E=S[I],U=E&&E.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,q=U.filter(function(le){return le.type===I});if(q.length&&(U.splice(U.indexOf(q[0]),1),delete this.revivers[I],delete this.types[I]),typeof E=="function"){var Y=E;E={test:function(J){return J&&J.constructor===Y},replace:function(J){return k({},J)},revive:function(J){return Object.assign(Object.create(Y.prototype),J)}}}else if(Be(E)){var ae=K(E,3);E={test:ae[0],replace:ae[1],revive:ae[2]}}if(E&&E.test){var Z={type:I,test:E.test.bind(E)};E.replace&&(Z.replace=E.replace.bind(E)),E.replaceAsync&&(Z.replaceAsync=E.replaceAsync.bind(E));var X=typeof i.fallback=="number"?i.fallback:i.fallback?0:Number.POSITIVE_INFINITY;if(E.testPlainObjects?this.plainObjectReplacers.splice(X,0,Z):this.nonplainObjectReplacers.splice(X,0,Z),E.revive||E.reviveAsync){var fe={};E.revive&&(fe.revive=E.revive.bind(E)),E.reviveAsync&&(fe.reviveAsync=E.reviveAsync.bind(E)),this.revivers[I]=[fe,{plain:E.testPlainObjects}]}this.types[I]=E}},this)},this),this}}]),n}(),pe=function n(){_(this,n)};pe.__typeson__type__="TypesonUndefined",$.Undefined=pe,$.Promise=N,$.isThenable=Pe,$.toStringTag=c,$.hasConstructorOf=r,$.isObject=l,$.isPlainObject=g,$.isUserObject=function n(e){if(!e||c(e)!=="Object")return!1;var t=ne(e);return!t||r(e,Object)||n(t)},$.escapeKeyPathComponent=ee,$.unescapeKeyPathComponent=M,$.getByKeyPath=ie,$.getJSONType=function(e){return e===null?"null":Array.isArray(e)?"array":s(e)},$.JSON_TYPES=["null","boolean","number","string","array","object"];for(var Le={userObject:{test:function(e,t){return $.isUserObject(e)},replace:function(e){return function(i){for(var a=1;a<arguments.length;a++){var S=arguments[a]!=null?arguments[a]:{};a%2?o(Object(S),!0).forEach(function(A){p(i,A,S[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(S)):o(Object(S)).forEach(function(A){Object.defineProperty(i,A,Object.getOwnPropertyDescriptor(S,A))})}return i}({},e)},revive:function(e){return e}}},f=[{arrayNonindexKeys:{testPlainObjects:!0,test:function(e,t){return!!Array.isArray(e)&&(Object.keys(e).some(function(i){return String(Number.parseInt(i))!==i})&&(t.iterateIn="object",t.addLength=!0),!0)},replace:function(e,t){return t.iterateUnsetNumeric=!0,e},revive:function(e){if(Array.isArray(e))return e;var t=[];return Object.keys(e).forEach(function(i){var a=e[i];t[i]=a}),t}}},{sparseUndefined:{test:function(e,t){return e===void 0&&t.ownKeys===!1},replace:function(e){return 0},revive:function(e){}}}],y={undef:{test:function(e,t){return e===void 0&&(t.ownKeys||!("ownKeys"in t))},replace:function(e){return 0},revive:function(e){return new $.Undefined}}},h={StringObject:{test:function(e){return $.toStringTag(e)==="String"&&u(e)==="object"},replace:function(e){return String(e)},revive:function(e){return new String(e)}},BooleanObject:{test:function(e){return $.toStringTag(e)==="Boolean"&&u(e)==="object"},replace:function(e){return Boolean(e)},revive:function(e){return new Boolean(e)}},NumberObject:{test:function(e){return $.toStringTag(e)==="Number"&&u(e)==="object"},replace:function(e){return Number(e)},revive:function(e){return new Number(e)}}},v=[{nan:{test:function(e){return Number.isNaN(e)},replace:function(e){return"NaN"},revive:function(e){return Number.NaN}}},{infinity:{test:function(e){return e===Number.POSITIVE_INFINITY},replace:function(e){return"Infinity"},revive:function(e){return Number.POSITIVE_INFINITY}}},{negativeInfinity:{test:function(e){return e===Number.NEGATIVE_INFINITY},replace:function(e){return"-Infinity"},revive:function(e){return Number.NEGATIVE_INFINITY}}}],O={date:{test:function(e){return $.toStringTag(e)==="Date"},replace:function(e){var t=e.getTime();return Number.isNaN(t)?"NaN":t},revive:function(e){return e==="NaN"?new Date(Number.NaN):new Date(e)}}},G={regexp:{test:function(e){return $.toStringTag(e)==="RegExp"},replace:function(e){return{source:e.source,flags:(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":"")}},revive:function(e){var t=e.source,i=e.flags;return new RegExp(t,i)}}},H={map:{test:function(e){return $.toStringTag(e)==="Map"},replace:function(e){return B(e.entries())},revive:function(e){return new Map(e)}}},W={set:{test:function(e){return $.toStringTag(e)==="Set"},replace:function(e){return B(e.values())},revive:function(e){return new Set(e)}}},x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ae=new Uint8Array(256),Re=0;Re<x.length;Re++)Ae[x.charCodeAt(Re)]=Re;var Ve=function(e,t,i){i==null&&(i=e.byteLength);for(var a=new Uint8Array(e,t||0,i),S=a.length,A="",I=0;I<S;I+=3)A+=x[a[I]>>2],A+=x[(3&a[I])<<4|a[I+1]>>4],A+=x[(15&a[I+1])<<2|a[I+2]>>6],A+=x[63&a[I+2]];return S%3==2?A=A.slice(0,-1)+"=":S%3==1&&(A=A.slice(0,-2)+"=="),A},Ye=function(e){var t,i,a,S,A=e.length,I=.75*e.length,E=0;e[e.length-1]==="="&&(I--,e[e.length-2]==="="&&I--);for(var U=new ArrayBuffer(I),q=new Uint8Array(U),Y=0;Y<A;Y+=4)t=Ae[e.charCodeAt(Y)],i=Ae[e.charCodeAt(Y+1)],a=Ae[e.charCodeAt(Y+2)],S=Ae[e.charCodeAt(Y+3)],q[E++]=t<<2|i>>4,q[E++]=(15&i)<<4|a>>2,q[E++]=(3&a)<<6|63&S;return U},Qe={arraybuffer:{test:function(e){return $.toStringTag(e)==="ArrayBuffer"},replace:function(e,t){t.buffers||(t.buffers=[]);var i=t.buffers.indexOf(e);return i>-1?{index:i}:(t.buffers.push(e),Ve(e))},revive:function(e,t){if(t.buffers||(t.buffers=[]),u(e)==="object")return t.buffers[e.index];var i=Ye(e);return t.buffers.push(i),i}}},Ze=typeof self=="undefined"?Ot:self,De={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(n){var e=n,t=Ze[e];t&&(De[n.toLowerCase()]={test:function(a){return $.toStringTag(a)===e},replace:function(a,S){var A=a.buffer,I=a.byteOffset,E=a.length;S.buffers||(S.buffers=[]);var U=S.buffers.indexOf(A);return U>-1?{index:U,byteOffset:I,length:E}:(S.buffers.push(A),{encoded:Ve(A),byteOffset:I,length:E})},revive:function(a,S){S.buffers||(S.buffers=[]);var A,I=a.byteOffset,E=a.length,U=a.encoded,q=a.index;return"index"in a?A=S.buffers[q]:(A=Ye(U),S.buffers.push(A)),new t(A,I,E)}})});var ze={dataview:{test:function(e){return $.toStringTag(e)==="DataView"},replace:function(e,t){var i=e.buffer,a=e.byteOffset,S=e.byteLength;t.buffers||(t.buffers=[]);var A=t.buffers.indexOf(i);return A>-1?{index:A,byteOffset:a,byteLength:S}:(t.buffers.push(i),{encoded:Ve(i),byteOffset:a,byteLength:S})},revive:function(e,t){t.buffers||(t.buffers=[]);var i,a=e.byteOffset,S=e.byteLength,A=e.encoded,I=e.index;return"index"in e?i=t.buffers[I]:(i=Ye(A),t.buffers.push(i)),new DataView(i,a,S)}}},ge={IntlCollator:{test:function(e){return $.hasConstructorOf(e,Intl.Collator)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.Collator(e.locale,e)}},IntlDateTimeFormat:{test:function(e){return $.hasConstructorOf(e,Intl.DateTimeFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.DateTimeFormat(e.locale,e)}},IntlNumberFormat:{test:function(e){return $.hasConstructorOf(e,Intl.NumberFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.NumberFormat(e.locale,e)}}};function oe(n){for(var e=new Uint8Array(n.length),t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e.buffer}var te={file:{test:function(e){return $.toStringTag(e)==="File"},replace:function(e){var t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),t.status!==200&&t.status!==0)throw new Error("Bad File access: "+t.status);return{type:e.type,stringContents:t.responseText,name:e.name,lastModified:e.lastModified}},revive:function(e){var t=e.name,i=e.type,a=e.stringContents,S=e.lastModified;return new File([oe(a)],t,{type:i,lastModified:S})},replaceAsync:function(e){return new $.Promise(function(t,i){var a=new FileReader;a.addEventListener("load",function(){t({type:e.type,stringContents:a.result,name:e.name,lastModified:e.lastModified})}),a.addEventListener("error",function(){i(a.error)}),a.readAsBinaryString(e)})}}},se={bigint:{test:function(e){return typeof e=="bigint"},replace:function(e){return String(e)},revive:function(e){return BigInt(e)}}},we={bigintObject:{test:function(e){return u(e)==="object"&&$.hasConstructorOf(e,BigInt)},replace:function(e){return String(e)},revive:function(e){return new Object(BigInt(e))}}},P={cryptokey:{test:function(e){return $.toStringTag(e)==="CryptoKey"&&e.extractable},replaceAsync:function(e){return new $.Promise(function(t,i){crypto.subtle.exportKey("jwk",e).catch(function(a){i(a)}).then(function(a){t({jwk:a,algorithm:e.algorithm,usages:e.usages})})})},revive:function(e){var t=e.jwk,i=e.algorithm,a=e.usages;return crypto.subtle.importKey("jwk",t,i,!0,a)}}};return[Le,y,f,h,v,O,G,{imagedata:{test:function(e){return $.toStringTag(e)==="ImageData"},replace:function(e){return{array:B(e.data),width:e.width,height:e.height}},revive:function(e){return new ImageData(new Uint8ClampedArray(e.array),e.width,e.height)}}},{imagebitmap:{test:function(e){return $.toStringTag(e)==="ImageBitmap"||e&&e.dataset&&e.dataset.toStringTag==="ImageBitmap"},replace:function(e){var t=document.createElement("canvas");return t.getContext("2d").drawImage(e,0,0),t.toDataURL()},revive:function(e){var t=document.createElement("canvas"),i=t.getContext("2d"),a=document.createElement("img");return a.addEventListener("load",function(){i.drawImage(a,0,0)}),a.src=e,t},reviveAsync:function(e){var t=document.createElement("canvas"),i=t.getContext("2d"),a=document.createElement("img");return a.addEventListener("load",function(){i.drawImage(a,0,0)}),a.src=e,createImageBitmap(t)}}},te,{file:te.file,filelist:{test:function(e){return $.toStringTag(e)==="FileList"},replace:function(e){for(var t=[],i=0;i<e.length;i++)t[i]=e.item(i);return t},revive:function(e){return new(function(){function t(){m(this,t),this._files=arguments[0],this.length=this._files.length}return function(a,S,A){return S&&w(a.prototype,S),A&&w(a,A),a}(t,[{key:"item",value:function(a){return this._files[a]}},{key:Symbol.toStringTag,get:function(){return"FileList"}}]),t}())(e)}}},{blob:{test:function(e){return $.toStringTag(e)==="Blob"},replace:function(e){var t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),t.status!==200&&t.status!==0)throw new Error("Bad Blob access: "+t.status);return{type:e.type,stringContents:t.responseText}},revive:function(e){var t=e.type,i=e.stringContents;return new Blob([oe(i)],{type:t})},replaceAsync:function(e){return new $.Promise(function(t,i){var a=new FileReader;a.addEventListener("load",function(){t({type:e.type,stringContents:a.result})}),a.addEventListener("error",function(){i(a.error)}),a.readAsBinaryString(e)})}}}].concat(typeof Map=="function"?H:[],typeof Set=="function"?W:[],typeof ArrayBuffer=="function"?Qe:[],typeof Uint8Array=="function"?De:[],typeof DataView=="function"?ze:[],typeof Intl!="undefined"?ge:[],typeof crypto!="undefined"?P:[],typeof BigInt!="undefined"?[se,we]:[])})}),ut="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lt=new Uint8Array(256);for(var dt=0;dt<ut.length;dt++)lt[ut.codePointAt(dt)]=dt;var At=function(b,u,m){m==null&&(m=b.byteLength);for(var w=new Uint8Array(b,u||0,m),p=w.length,o="",B=0;B<p;B+=3)o+=ut[w[B]>>2],o+=ut[(w[B]&3)<<4|w[B+1]>>4],o+=ut[(w[B+1]&15)<<2|w[B+2]>>6],o+=ut[w[B+2]&63];return p%3===2?o=o.slice(0,-1)+"=":p%3===1&&(o=o.slice(0,-2)+"=="),o},Lt=function(b){var u=b.length,m=b.length*.75,w=0,p,o,B,L;b[b.length-1]==="="&&(m--,b[b.length-2]==="="&&m--);for(var s=new ArrayBuffer(m),_=new Uint8Array(s),F=0;F<u;F+=4)p=lt[b.codePointAt(F)],o=lt[b.codePointAt(F+1)],B=lt[b.codePointAt(F+2)],L=lt[b.codePointAt(F+3)],_[w++]=p<<2|o>>4,_[w++]=(o&15)<<4|B>>2,_[w++]=(B&3)<<6|L&63;return s},Zt=typeof self=="undefined"?global:self,Rt={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(d){var b=d,u=Zt[b];u&&(Rt[d.toLowerCase()+"2"]={test:function(m){return vt.toStringTag(m)===b},replace:function(m){var w=m.buffer,p=m.byteOffset,o=m.length;return{buffer:w,byteOffset:p,length:o}},revive:function(m){var w=m.buffer,p=m.byteOffset,o=m.length;return new u(w,p,o)}})});var en={arraybuffer:{test:function(d){return vt.toStringTag(d)==="ArrayBuffer"},replace:function(d){return At(d,0,d.byteLength)},revive:function(d){var b=Lt(d);return b}}},Ge=new vt().register(Xt),tn="FileReaderSync"in self,ht=[],Tt=0;Ge.register([en,Rt,{blob2:{test:function(d){return vt.toStringTag(d)==="Blob"},replace:function(d){if(d.isClosed)throw new Error("The Blob is closed");if(tn){var b=jt(d,"binary"),u=At(b,0,b.byteLength);return{type:d.type,data:u}}else{ht.push(d);var m={type:d.type,data:{start:Tt,end:Tt+d.size}};return Tt+=d.size,m}},finalize:function(d,b){d.data=At(b,0,b.byteLength)},revive:function(d){var b=d.type,u=d.data;return new Blob([Lt(u)],{type:b})}}}]);Ge.mustFinalize=function(){return ht.length>0};Ge.finalize=function(d){return it(void 0,void 0,void 0,function(){var b,u,m,w,p,o,B,L,s,_;return Xe(this,function(F){switch(F.label){case 0:return[4,xt(new Blob(ht),"binary")];case 1:if(b=F.sent(),d){for(u=0,m=d;u<m.length;u++)if(w=m[u],w.$types){p=w.$types,o=p.$,o&&(p=p.$);for(B in p)L=p[B],s=Ge.types[L],s&&s.finalize&&(_=Fe.getByKeyPath(w,o?"$."+B:B),s.finalize(_,b.slice(_.start,_.end)))}}return ht=[],[2]}})})};var nn=2e3;function rn(d,b){return it(this,void 0,void 0,function(){function u(){return it(this,void 0,void 0,function(){var F,he,be,k,K,z,Ne,me,N,Ce;return Xe(this,function(D){switch(D.label){case 0:return[4,Promise.all(w.map(function(ne){return ne.count()}))];case 1:F=D.sent(),F.forEach(function(ne,re){return o[re].rowCount=ne}),_.totalRows=F.reduce(function(ne,re){return ne+re}),he=JSON.stringify(L,void 0,B?2:void 0),be=he.lastIndexOf("]"),k=he.substring(0,be),p.push(k),K=b.filter,z=b.transform,Ne=function(ne){var re,Pe,c,r,g,l,ee,M,ie,de,Te,xe;return Xe(this,function(Be){switch(Be.label){case 0:re=d.table(ne),Pe=re.schema.primKey,c=!!Pe.keyPath,r=b.numRowsPerChunk||nn,g=c?{tableName:re.name,inbound:!0,rows:[]}:{tableName:re.name,inbound:!1,rows:[]},l=JSON.stringify(g,void 0,B?2:void 0),B&&(l=l.split(`
`).join(`
    `)),ee=l.lastIndexOf("]"),p.push(l.substring(0,ee)),M=null,ie=0,de=!0,Te=function(){var ce,ve,je,qe,$,y,pe,Le,f,y;return Xe(this,function(h){switch(h.label){case 0:return s&&Fe.ignoreTransaction(function(){return s(_)}),ce=M==null?re.limit(r):re.where(":id").above(M).limit(r),[4,ce.toArray()];case 1:return ve=h.sent(),ve.length===0?[2,"break"]:(M!=null&&ie>0&&(p.push(","),B&&p.push(`
      `)),de=ve.length===r,c?(je=K?ve.filter(function(v){return K(ne,v)}):ve,qe=z?je.map(function(v){return z(ne,v).value}):je,$=qe.map(function(v){return Ge.encapsulate(v)}),Ge.mustFinalize()?[4,Fe.waitFor(Ge.finalize($))]:[3,3]):[3,4]);case 2:h.sent(),h.label=3;case 3:return y=JSON.stringify($,void 0,B?2:void 0),B&&(y=y.split(`
`).join(`
      `)),p.push(new Blob([y.substring(1,y.length-1)])),ie=qe.length,M=ve.length>0?Fe.getByKeyPath(ve[ve.length-1],Pe.keyPath):null,[3,8];case 4:return[4,ce.primaryKeys()];case 5:return pe=h.sent(),Le=pe.map(function(v,O){return[v,ve[O]]}),K&&(Le=Le.filter(function(v){var O=v[0],G=v[1];return K(ne,G,O)})),z&&(Le=Le.map(function(v){var O=v[0],G=v[1],H=z(ne,G,O);return[H.key,H.value]})),f=Le.map(function(v){return Ge.encapsulate(v)}),Ge.mustFinalize()?[4,Fe.waitFor(Ge.finalize(f))]:[3,7];case 6:h.sent(),h.label=7;case 7:y=JSON.stringify(f,void 0,B?2:void 0),B&&(y=y.split(`
`).join(`
      `)),p.push(new Blob([y.substring(1,y.length-1)])),ie=Le.length,M=pe.length>0?pe[pe.length-1]:null,h.label=8;case 8:return _.completedRows+=ve.length,[2]}})},Be.label=1;case 1:return de?[5,Te()]:[3,3];case 2:return xe=Be.sent(),xe==="break"?[3,3]:[3,1];case 3:return p.push(l.substr(ee)),_.completedTables+=1,_.completedTables<_.totalTables&&p.push(","),[2]}})},me=0,N=o,D.label=2;case 2:return me<N.length?(Ce=N[me].name,[5,Ne(Ce)]):[3,5];case 3:D.sent(),D.label=4;case 4:return me++,[3,2];case 5:return p.push(he.substr(be)),_.done=!0,s&&Fe.ignoreTransaction(function(){return s(_)}),[2]}})})}var m,w,p,o,B,L,s,_;return Xe(this,function(F){switch(F.label){case 0:b=b||{},m=b.skipTables?b.skipTables:[],w=d.tables.filter(function(he){return!m.includes(he.name)}),p=[],o=w.map(function(he){return{name:he.name,schema:Ht(he),rowCount:0}}),B=b.prettyJson,L={formatName:"dexie",formatVersion:1,data:{databaseName:d.name,databaseVersion:d.verno,tables:o,data:[]}},s=b.progressCallback,_={done:!1,completedRows:0,completedTables:0,totalRows:NaN,totalTables:o.length},F.label=1;case 1:return F.trys.push([1,,6,7]),b.noTransaction?[4,u()]:[3,3];case 2:return F.sent(),[3,5];case 3:return[4,d.transaction("r",d.tables,u)];case 4:F.sent(),F.label=5;case 5:return[3,7];case 6:return Ge.finalize(),[7];case 7:return[2,new Blob(p,{type:"text/json"})]}})})}var an=1,on={Stream:function(){}},sn=Et(function(d,b){(function(u){var m=typeof process=="object"&&process.env?process.env:self;u.parser=function(c){return new be(c)},u.CParser=be,u.CStream=K,u.createStream=k,u.MAX_BUFFER_LENGTH=10*1024*1024,u.DEBUG=m.CDEBUG==="debug",u.INFO=m.CDEBUG==="debug"||m.CDEBUG==="info",u.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var w={textNode:void 0,numberNode:""},p=u.EVENTS.filter(function(c){return c!=="error"&&c!=="end"}),o=0,B;u.STATE={BEGIN:o++,VALUE:o++,OPEN_OBJECT:o++,CLOSE_OBJECT:o++,OPEN_ARRAY:o++,CLOSE_ARRAY:o++,TEXT_ESCAPE:o++,STRING:o++,BACKSLASH:o++,END:o++,OPEN_KEY:o++,CLOSE_KEY:o++,TRUE:o++,TRUE2:o++,TRUE3:o++,FALSE:o++,FALSE2:o++,FALSE3:o++,FALSE4:o++,NULL:o++,NULL2:o++,NULL3:o++,NUMBER_DECIMAL_POINT:o++,NUMBER_DIGIT:o++};for(var L in u.STATE)u.STATE[u.STATE[L]]=L;o=u.STATE;const s={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125};Object.create||(Object.create=function(c){function r(){this.__proto__=c}return r.prototype=c,new r}),Object.getPrototypeOf||(Object.getPrototypeOf=function(c){return c.__proto__}),Object.keys||(Object.keys=function(c){var r=[];for(var g in c)c.hasOwnProperty(g)&&r.push(g);return r});function _(c){var r=Math.max(u.MAX_BUFFER_LENGTH,10),g=0;for(var l in w){var ee=c[l]===void 0?0:c[l].length;if(ee>r)switch(l){case"text":closeText(c);break;default:D(c,"Max buffer length exceeded: "+l)}g=Math.max(g,ee)}c.bufferCheckPosition=u.MAX_BUFFER_LENGTH-g+c.position}function F(c){for(var r in w)c[r]=w[r]}var he=/[\\"\n]/g;function be(c){if(!(this instanceof be))return new be(c);var r=this;F(r),r.bufferCheckPosition=u.MAX_BUFFER_LENGTH,r.q=r.c=r.p="",r.opt=c||{},r.closed=r.closedRoot=r.sawRoot=!1,r.tag=r.error=null,r.state=o.BEGIN,r.stack=new Array,r.position=r.column=0,r.line=1,r.slashed=!1,r.unicodeI=0,r.unicodeS=null,r.depth=0,z(r,"onready")}be.prototype={end:function(){ne(this)},write:Pe,resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{B=on.Stream}catch{B=function(){}}function k(c){return new K(c)}function K(c){if(!(this instanceof K))return new K(c);this._parser=new be(c),this.writable=!0,this.readable=!0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.string="";var r=this;B.apply(r),this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(g){r.emit("error",g),r._parser.error=null},p.forEach(function(g){Object.defineProperty(r,"on"+g,{get:function(){return r._parser["on"+g]},set:function(l){if(!l)return r.removeAllListeners(g),r._parser["on"+g]=l,l;r.on(g,l)},enumerable:!0,configurable:!1})})}K.prototype=Object.create(B.prototype,{constructor:{value:K}}),K.prototype.write=function(c){c=new Buffer(c);for(var r=0;r<c.length;r++){var g=c[r];if(this.bytes_remaining>0){for(var l=0;l<this.bytes_remaining;l++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+l]=c[l];this.string=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,r=r+l-1,this._parser.write(this.string),this.emit("data",this.string);continue}if(this.bytes_remaining===0&&g>=128)if(g>=194&&g<=223&&(this.bytes_in_sequence=2),g>=224&&g<=239&&(this.bytes_in_sequence=3),g>=240&&g<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+r>c.length){for(var ee=0;ee<=c.length-1-r;ee++)this.temp_buffs[this.bytes_in_sequence][ee]=c[r+ee];return this.bytes_remaining=r+this.bytes_in_sequence-c.length,!0}else{this.string=c.slice(r,r+this.bytes_in_sequence).toString(),r=r+this.bytes_in_sequence-1,this._parser.write(this.string),this.emit("data",this.string);continue}for(var M=r;M<c.length&&!(c[M]>=128);M++);this.string=c.slice(r,M).toString(),this._parser.write(this.string),this.emit("data",this.string),r=M-1}},K.prototype.end=function(c){return c&&c.length&&this._parser.write(c.toString()),this._parser.end(),!0},K.prototype.on=function(c,r){var g=this;return!g._parser["on"+c]&&p.indexOf(c)!==-1&&(g._parser["on"+c]=function(){var l=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);l.splice(0,0,c),g.emit.apply(g,l)}),B.prototype.on.call(g,c,r)},K.prototype.destroy=function(){F(this._parser),this.emit("close")};function z(c,r,g){u.INFO&&console.log("-- emit",r,g),c[r]&&c[r](g)}function Ne(c,r,g){me(c),z(c,r,g)}function me(c,r){c.textNode=Ce(c.opt,c.textNode),c.textNode!==void 0&&z(c,r||"onvalue",c.textNode),c.textNode=void 0}function N(c){c.numberNode&&z(c,"onvalue",parseFloat(c.numberNode)),c.numberNode=""}function Ce(c,r){return r===void 0||(c.trim&&(r=r.trim()),c.normalize&&(r=r.replace(/\s+/g," "))),r}function D(c,r){return me(c),r+=`
Line: `+c.line+`
Column: `+c.column+`
Char: `+c.c,r=new Error(r),c.error=r,z(c,"onerror",r),c}function ne(c){return(c.state!==o.VALUE||c.depth!==0)&&D(c,"Unexpected end"),me(c),c.c="",c.closed=!0,z(c,"onend"),be.call(c,c.opt),c}function re(c){return c===s.carriageReturn||c===s.lineFeed||c===s.space||c===s.tab}function Pe(c){var r=this;if(this.error)throw this.error;if(r.closed)return D(r,"Cannot write after close. Assign an onready handler.");if(c===null)return ne(r);var g=0,l=c.charCodeAt(0),ee=r.p;for(u.DEBUG&&console.log("write -> ["+c+"]");l&&(ee=l,r.c=l=c.charCodeAt(g++),ee!==l?r.p=ee:ee=r.p,!!l);)switch(u.DEBUG&&console.log(g,l,u.STATE[r.state]),r.position++,l===s.lineFeed?(r.line++,r.column=0):r.column++,r.state){case o.BEGIN:l===s.openBrace?r.state=o.OPEN_OBJECT:l===s.openBracket?r.state=o.OPEN_ARRAY:re(l)||D(r,"Non-whitespace before {[.");continue;case o.OPEN_KEY:case o.OPEN_OBJECT:if(re(l))continue;if(r.state===o.OPEN_KEY)r.stack.push(o.CLOSE_KEY);else if(l===s.closeBrace){z(r,"onopenobject"),this.depth++,z(r,"oncloseobject"),this.depth--,r.state=r.stack.pop()||o.VALUE;continue}else r.stack.push(o.CLOSE_OBJECT);l===s.doubleQuote?r.state=o.STRING:D(r,'Malformed object key should start with "');continue;case o.CLOSE_KEY:case o.CLOSE_OBJECT:if(re(l))continue;r.state,o.CLOSE_KEY,l===s.colon?(r.state===o.CLOSE_OBJECT?(r.stack.push(o.CLOSE_OBJECT),me(r,"onopenobject"),this.depth++):me(r,"onkey"),r.state=o.VALUE):l===s.closeBrace?(Ne(r,"oncloseobject"),this.depth--,r.state=r.stack.pop()||o.VALUE):l===s.comma?(r.state===o.CLOSE_OBJECT&&r.stack.push(o.CLOSE_OBJECT),me(r),r.state=o.OPEN_KEY):D(r,"Bad object");continue;case o.OPEN_ARRAY:case o.VALUE:if(re(l))continue;if(r.state===o.OPEN_ARRAY)if(z(r,"onopenarray"),this.depth++,r.state=o.VALUE,l===s.closeBracket){z(r,"onclosearray"),this.depth--,r.state=r.stack.pop()||o.VALUE;continue}else r.stack.push(o.CLOSE_ARRAY);l===s.doubleQuote?r.state=o.STRING:l===s.openBrace?r.state=o.OPEN_OBJECT:l===s.openBracket?r.state=o.OPEN_ARRAY:l===s.t?r.state=o.TRUE:l===s.f?r.state=o.FALSE:l===s.n?r.state=o.NULL:l===s.minus?r.numberNode+="-":s._0<=l&&l<=s._9?(r.numberNode+=String.fromCharCode(l),r.state=o.NUMBER_DIGIT):D(r,"Bad value");continue;case o.CLOSE_ARRAY:if(l===s.comma)r.stack.push(o.CLOSE_ARRAY),me(r,"onvalue"),r.state=o.VALUE;else if(l===s.closeBracket)Ne(r,"onclosearray"),this.depth--,r.state=r.stack.pop()||o.VALUE;else{if(re(l))continue;D(r,"Bad array")}continue;case o.STRING:r.textNode===void 0&&(r.textNode="");var M=g-1,ie=r.slashed,de=r.unicodeI;e:for(;;){for(u.DEBUG&&console.log(g,l,u.STATE[r.state],ie);de>0;)if(r.unicodeS+=String.fromCharCode(l),l=c.charCodeAt(g++),r.position++,de===4?(r.textNode+=String.fromCharCode(parseInt(r.unicodeS,16)),de=0,M=g-1):de++,!l)break e;if(l===s.doubleQuote&&!ie){r.state=r.stack.pop()||o.VALUE,r.textNode+=c.substring(M,g-1),r.position+=g-1-M;break}if(l===s.backslash&&!ie&&(ie=!0,r.textNode+=c.substring(M,g-1),r.position+=g-1-M,l=c.charCodeAt(g++),r.position++,!l))break;if(ie){if(ie=!1,l===s.n?r.textNode+=`
`:l===s.r?r.textNode+="\r":l===s.t?r.textNode+="	":l===s.f?r.textNode+="\f":l===s.b?r.textNode+="\b":l===s.u?(de=1,r.unicodeS=""):r.textNode+=String.fromCharCode(l),l=c.charCodeAt(g++),r.position++,M=g-1,l)continue;break}he.lastIndex=g;var Te=he.exec(c);if(Te===null){g=c.length+1,r.textNode+=c.substring(M,g-1),r.position+=g-1-M;break}if(g=Te.index+1,l=c.charCodeAt(Te.index),!l){r.textNode+=c.substring(M,g-1),r.position+=g-1-M;break}}r.slashed=ie,r.unicodeI=de;continue;case o.TRUE:l===s.r?r.state=o.TRUE2:D(r,"Invalid true started with t"+l);continue;case o.TRUE2:l===s.u?r.state=o.TRUE3:D(r,"Invalid true started with tr"+l);continue;case o.TRUE3:l===s.e?(z(r,"onvalue",!0),r.state=r.stack.pop()||o.VALUE):D(r,"Invalid true started with tru"+l);continue;case o.FALSE:l===s.a?r.state=o.FALSE2:D(r,"Invalid false started with f"+l);continue;case o.FALSE2:l===s.l?r.state=o.FALSE3:D(r,"Invalid false started with fa"+l);continue;case o.FALSE3:l===s.s?r.state=o.FALSE4:D(r,"Invalid false started with fal"+l);continue;case o.FALSE4:l===s.e?(z(r,"onvalue",!1),r.state=r.stack.pop()||o.VALUE):D(r,"Invalid false started with fals"+l);continue;case o.NULL:l===s.u?r.state=o.NULL2:D(r,"Invalid null started with n"+l);continue;case o.NULL2:l===s.l?r.state=o.NULL3:D(r,"Invalid null started with nu"+l);continue;case o.NULL3:l===s.l?(z(r,"onvalue",null),r.state=r.stack.pop()||o.VALUE):D(r,"Invalid null started with nul"+l);continue;case o.NUMBER_DECIMAL_POINT:l===s.period?(r.numberNode+=".",r.state=o.NUMBER_DIGIT):D(r,"Leading zero not followed by .");continue;case o.NUMBER_DIGIT:s._0<=l&&l<=s._9?r.numberNode+=String.fromCharCode(l):l===s.period?(r.numberNode.indexOf(".")!==-1&&D(r,"Invalid number has two dots"),r.numberNode+="."):l===s.e||l===s.E?((r.numberNode.indexOf("e")!==-1||r.numberNode.indexOf("E")!==-1)&&D(r,"Invalid number has two exponential"),r.numberNode+="e"):l===s.plus||l===s.minus?(ee===s.e||ee===s.E||D(r,"Invalid symbol in number"),r.numberNode+=String.fromCharCode(l)):(N(r),g--,r.state=r.stack.pop()||o.VALUE);continue;default:D(r,"Unknown state: "+r.state)}return r.position>=r.bufferCheckPosition&&_(r),r}})(b)});function un(d){var b=0,u=cn(!0),m={pullAsync:function(w){return it(this,void 0,void 0,function(){var p,o,B;return Xe(this,function(L){switch(L.label){case 0:return p=d.slice(b,b+w),b+=w,[4,xt(p,"text")];case 1:return o=L.sent(),B=u.write(o),m.result=B||{},[2,B]}})})},pullSync:function(w){var p=d.slice(b,b+w);b+=w;var o=jt(p,"text"),B=u.write(o);return m.result=B||{},B},done:function(){return u.done()},eof:function(){return b>=d.size},result:{}};return m}function cn(d){var b=sn.parser(),u=0,m,w=[],p,o,B=!1,L=!1;return b.onopenobject=function(s){var _={};_.incomplete=!0,m||(m=_),p&&(w.push([o,p,L]),d&&(L?p.push(_):p[o]=_)),p=_,o=s,L=!1,++u},b.onkey=function(s){return o=s},b.onvalue=function(s){return L?p.push(s):p[o]=s},b.oncloseobject=function(){var s;if(delete p.incomplete,o=null,--u===0)B=!0;else{var _=p;s=w.pop(),o=s[0],p=s[1],L=s[2],d||(L?p.push(_):p[o]=_)}},b.onopenarray=function(){var s=[];s.incomplete=!0,m||(m=s),p&&(w.push([o,p,L]),d&&(L?p.push(s):p[o]=s)),p=s,L=!0,o=null,++u},b.onclosearray=function(){var s;if(delete p.incomplete,o=null,--u===0)B=!0;else{var _=p;s=w.pop(),o=s[0],p=s[1],L=s[2],d||(L?p.push(_):p[o]=_)}},{write:function(s){return b.write(s),m},done:function(){return B}}}var Ut=1024;function fn(d,b){return it(this,void 0,void 0,function(){var u,m,w,p;return Xe(this,function(o){switch(o.label){case 0:return b=b||{},u=b.chunkSizeBytes||Ut*1024,[4,Vt(d,u)];case 1:return m=o.sent(),w=m.result.data,p=new Fe(w.databaseName),p.version(w.databaseVersion).stores(Wt(w)),[4,Ft(p,m,b)];case 2:return o.sent(),[2,p]}})})}function Ft(d,b,u){return it(this,void 0,void 0,function(){function m(){return it(this,void 0,void 0,function(){var K,z,Ne,me,N;return Xe(this,function(Ce){switch(Ce.label){case 0:K=function(D){var ne,re,Pe,c,r,g,l,ee,M,ie,de,Te,xe;return Xe(this,function(Be){switch(Be.label){case 0:if(s.includes(D.tableName))return[2,"continue"];if(!D.rows)return[2,"break"];if(!D.rows.incomplete&&D.rows.length===0)return[2,"continue"];if(_&&Fe.ignoreTransaction(function(){return _(F)}),ne=D.tableName,re=d.table(ne),Pe=L.tables.filter(function(ce){return ce.name===ne})[0].schema,!re){if(u.acceptMissingTables)return[2,"continue"];throw new Error("Exported table ".concat(D.tableName," is missing in installed database"))}if(!u.acceptChangedPrimaryKey&&Pe.split(",")[0]!=re.schema.primKey.src)throw new Error("Primary key differs for table ".concat(D.tableName,". "));for(c=D.rows,r=[],g=0;g<c.length&&(l=c[g],!l.incomplete);g++)r.push(Ge.revive(l));return ee=u.filter,M=u.transform,ie=ee?D.inbound?r.filter(function(ce){return ee(ne,ce)}):r.filter(function(ce){var ve=ce[0],je=ce[1];return ee(ne,je,ve)}):r,M&&(ie=ie.map(D.inbound?function(ce){return M(ne,ce).value}:function(ce){var ve=ce[0],je=ce[1],qe=M(ne,je,ve);return[qe.key,qe.value]})),de=D.inbound?[void 0,ie]:[ie.map(function(ce){return ce[0]}),r.map(function(ce){return ce[1]})],Te=de[0],xe=de[1],u.overwriteValues?[4,re.bulkPut(xe,Te)]:[3,2];case 1:return Be.sent(),[3,4];case 2:return[4,re.bulkAdd(xe,Te)];case 3:Be.sent(),Be.label=4;case 4:return F.completedRows+=r.length,r.incomplete||(F.completedTables+=1),c.splice(0,r.length),[2]}})},z=0,Ne=L.data,Ce.label=1;case 1:return z<Ne.length?(me=Ne[z],[5,K(me)]):[3,4];case 2:if(N=Ce.sent(),N==="break")return[3,4];Ce.label=3;case 3:return z++,[3,1];case 4:for(;L.data.length>0&&L.data[0].rows&&!L.data[0].rows.incomplete;)L.data.splice(0,1);return!p.done()&&!p.eof()?B?(p.pullSync(w),[3,7]):[3,5]:[3,8];case 5:return[4,Fe.waitFor(p.pullAsync(w))];case 6:Ce.sent(),Ce.label=7;case 7:return[3,9];case 8:return[3,10];case 9:return[3,0];case 10:return[2]}})})}var w,p,o,B,L,s,_,F,he,be,k;return Xe(this,function(K){switch(K.label){case 0:return u=u||{},w=u.chunkSizeBytes||Ut*1024,[4,Vt(b,w)];case 1:if(p=K.sent(),o=p.result,B="FileReaderSync"in self,L=o.data,s=u.skipTables?u.skipTables:[],!u.acceptNameDiff&&d.name!==L.databaseName)throw new Error("Name differs. Current database name is ".concat(d.name," but export is ").concat(L.databaseName));if(!u.acceptVersionDiff&&d.verno!==L.databaseVersion)throw new Error("Database version differs. Current database is in version ".concat(d.verno," but export is ").concat(L.databaseVersion));if(_=u.progressCallback,F={done:!1,completedRows:0,completedTables:0,totalRows:L.tables.reduce(function(z,Ne){return z+Ne.rowCount},0),totalTables:L.tables.length},_&&Fe.ignoreTransaction(function(){return _(F)}),!u.clearTablesBeforeImport)return[3,5];he=0,be=d.tables,K.label=2;case 2:return he<be.length?(k=be[he],s.includes(k.name)?[3,4]:[4,k.clear()]):[3,5];case 3:K.sent(),K.label=4;case 4:return he++,[3,2];case 5:return u.noTransaction?[4,m()]:[3,7];case 6:return K.sent(),[3,9];case 7:return[4,d.transaction("rw",d.tables,m)];case 8:K.sent(),K.label=9;case 9:return F.done=!0,_&&Fe.ignoreTransaction(function(){return _(F)}),[2]}})})}function Vt(d,b){return it(this,void 0,void 0,function(){var u,m;return Xe(this,function(w){switch(w.label){case 0:u="slice"in d?un(d):d,w.label=1;case 1:return u.eof()?[3,3]:[4,u.pullAsync(b)];case 2:return w.sent(),u.result.data&&u.result.data.data?[3,3]:[3,1];case 3:if(m=u.result,!m||m.formatName!="dexie")throw new Error("Given file is not a dexie export");if(m.formatVersion>an)throw new Error("Format version ".concat(m.formatVersion," not supported"));if(!m.data)throw new Error("No data in export file");if(!m.data.databaseName)throw new Error("Missing databaseName in export file");if(!m.data.databaseVersion)throw new Error("Missing databaseVersion in export file");if(!m.data.tables)throw new Error("Missing tables in export file");return[2,u]}})})}Fe.prototype.export=function(d){return rn(this,d)};Fe.prototype.import=function(d,b){return Ft(this,d,b)};Fe.import=function(d,b){return fn(d,b)};var Pt;(function(d){d.Documents="DOCUMENTS",d.Data="DATA",d.Library="LIBRARY",d.Cache="CACHE",d.External="EXTERNAL",d.ExternalStorage="EXTERNAL_STORAGE"})(Pt||(Pt={}));var _t;(function(d){d.UTF8="utf8",d.ASCII="ascii",d.UTF16="utf16"})(_t||(_t={}));const ln=It("Filesystem",{web:()=>Dt(()=>import("./web.cd3fa976.js"),["assets/web.cd3fa976.js","assets/index.af9e0f6e.js","assets/index.c15f65ed.css","assets/QItem.8815b672.js","assets/QList.27091de1.js","assets/CSelect.9df630b2.js","assets/QMenu.8ec9ede0.js","assets/selection.bf6e3a61.js","assets/use-virtual-scroll.52cd128c.js","assets/format.c860d4da.js","assets/mitt.4e333a4b.js","assets/settingsStore.5309004a.js","assets/dexie.e9b82229.js","assets/index.f4699e16.js","assets/index.9da299ca.js"]).then(d=>new d.FilesystemWeb)}),nt=It("FilePicker");async function pn(d){const b=await kt.export();dn(b,d)}async function yn(d){const b=await hn(d);await kt.import(b,{overwriteValues:!0,clearTablesBeforeImport:!0,acceptVersionDiff:!0})}async function dn(d,b){const u=await d.text();rt.is.mobile&&nt.createFile({path:b,fileName:`RefuelTrackerBackup_${zt()}.json`,mimeType:"*/*",data:u})}async function hn(d){if(rt.is.mobile){const b=await ln.readFile({path:d,encoding:_t.UTF8});return new Blob([b.data],{type:"application/json"})}return Promise.resolve(new Blob)}const vn={class:"q-pa-md q-gutter-md"},bn=$t({__name:"Settings",setup(d){let b,u;const m=Qt(),w=[{label:"Space Station",value:1},{label:"Dark",value:2},{label:"Light",value:3},{label:"High Contrast",value:4},{label:"Red Green Weakness",value:5}],p=wt(m.selectedColorThemeId),o=wt(m.plateNumberInTitleActive),B=wt(m.autoBackupActive);function L(k){m.changeColorTheme(k)}function s(k){m.togglePlateNumberInTitle(k)}async function _(k){k&&rt.is.mobile&&await nt.openDocumentTree(),m.toggleAutoBackup(k)}async function F(){rt.is.mobile&&await nt.openDocumentTree()}async function he(){u=k=>{(async()=>(m.setAutoBackupPath(k.path),await pn(k.path),Ct.create("Backup exported")))()},rt.is.mobile&&await nt.openDocumentTree()}async function be(){b=k=>{(async()=>(await yn(k.path),Ct.create("Backup imported")))()},rt.is.mobile&&await nt.getContent({mimeType:"*/*"})}return Kt(()=>{Yt.emit("updateTitle","Settings"),rt.is.mobile&&(nt.addListener("getContentResult",k=>{b(k)}),nt.addListener("openDocumentTreeResult",k=>{u(k)}))}),Jt(()=>{rt.is.mobile&&nt.removeAllListeners()}),(k,K)=>(Mt(),Gt("div",vn,[Oe(St,null,{default:Ee(()=>[Nt("",!0),Oe(ct,{header:""},{default:Ee(()=>[ft("Settings")]),_:1}),Oe(St,{class:"q-pb-md"},{default:Ee(()=>[Oe(gt,{tag:"label"},{default:Ee(()=>[Oe(st,null,{default:Ee(()=>[Oe(ct,null,{default:Ee(()=>[ft("Show number plate title")]),_:1})]),_:1}),Oe(st,{avatar:""},{default:Ee(()=>[Oe(qt,{modelValue:o.value,"onUpdate:modelValue":[K[1]||(K[1]=z=>o.value=z),s],color:"positive"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),Oe(ct,{header:""},{default:Ee(()=>[ft("Backup")]),_:1}),Oe(St,{class:"q-pb-md"},{default:Ee(()=>[Nt("",!0),Oe(gt,{tag:"label"},{default:Ee(()=>[Oe(st,null,{default:Ee(()=>[Oe(ct,null,{default:Ee(()=>[ft("Export")]),_:1})]),_:1}),Oe(st,{avatar:""},{default:Ee(()=>[Oe(Bt,{label:"Export",color:"positive",onClick:he})]),_:1})]),_:1}),Oe(gt,{tag:"label"},{default:Ee(()=>[Oe(st,null,{default:Ee(()=>[Oe(ct,null,{default:Ee(()=>[ft("Import")]),_:1})]),_:1}),Oe(st,{avatar:""},{default:Ee(()=>[Oe(Bt,{label:"Import",color:"positive",onClick:be})]),_:1})]),_:1})]),_:1})]),_:1})]))}});var Nn=Object.freeze(Object.defineProperty({__proto__:null,default:bn},Symbol.toStringTag,{value:"Module"}));export{_t as E,Nn as S};
